(window.webpackJsonp=window.webpackJsonp||[]).push([[335],{1867:function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return y}));var r=n(2),a=n(335),s=n(319),c=n.n(s),i=n(31),o=n(452),l=n(316),u=n(318),m=n(312),p=n(354);class d extends r.PureComponent{constructor(){super(...arguments),this.mounted=!1,this.state={encrypting:!1,generating:!1,value:""},this.handleChange=e=>{this.setState({value:e.currentTarget.value})},this.handleEncrypt=e=>{e.preventDefault(),this.setState({encrypting:!0}),Object(o.b)(this.state.value).then(({encryptedValue:e})=>{this.mounted&&this.setState({encryptedValue:e,encrypting:!1})},()=>{this.mounted&&this.setState({encrypting:!1})})},this.handleGenerateSecretKey=e=>{e.preventDefault(),this.setState({generating:!0}),this.props.generateSecretKey().then(this.stopGenerating,this.stopGenerating)},this.stopGenerating=()=>{this.mounted&&this.setState({generating:!1})}}componentDidMount(){this.mounted=!0}componentWillUnmount(){this.mounted=!1}render(){const{encryptedValue:e,encrypting:t,generating:n}=this.state;return r.createElement("div",{id:"encryption-form-container"},r.createElement("div",{className:"spacer-bottom"},Object(i.translate)("encryption.form_intro")),r.createElement("form",{className:"big-spacer-bottom",id:"encryption-form",onSubmit:this.handleEncrypt},r.createElement("textarea",{autoFocus:!0,className:"abs-width-600",id:"encryption-form-value",onChange:this.handleChange,required:!0,rows:5,value:this.state.value}),r.createElement("div",{className:"spacer-top"},r.createElement(m.SubmitButton,{disabled:t||n},Object(i.translate)("encryption.encrypt")),r.createElement(c.a,{className:"spacer-left",loading:t}))),e&&r.createElement("div",null,r.createElement("span",{className:"little-spacer-right"},Object(i.translate)("encryption.encrypted_value")),r.createElement("input",{className:"input-clear input-code input-super-large",id:"encrypted-value",readOnly:!0,type:"text",value:e}),r.createElement(p.ClipboardButton,{className:"little-spacer-left",copyValue:e})),r.createElement("form",{className:"huge-spacer-top bordered-top",id:"encryption-new-key-form",onSubmit:this.handleGenerateSecretKey},r.createElement("p",{className:"big-spacer-top spacer-bottom"},r.createElement(l.FormattedMessage,{defaultMessage:Object(i.translate)("encryption.form_note"),id:"encryption.form_note",values:{moreInformationLink:r.createElement(u.c,{to:"/documentation/instance-administration/security/",target:"_blank"},Object(i.translate)("more_information"))}})),r.createElement(m.SubmitButton,{disabled:n||t},Object(i.translate)("encryption.generate_new_secret_key")," "),r.createElement(c.a,{className:"spacer-left",loading:n})))}}class h extends r.PureComponent{constructor(){super(...arguments),this.mounted=!1,this.state={submitting:!1},this.handleSubmit=e=>{e.preventDefault(),this.setState({submitting:!0}),this.props.generateSecretKey().then(this.stopSubmitting,this.stopSubmitting)},this.stopSubmitting=()=>{this.mounted&&this.setState({submitting:!1})}}componentDidMount(){this.mounted=!0}componentWillUnmount(){this.mounted=!1}render(){const{secretKey:e}=this.props,{submitting:t}=this.state;return r.createElement("div",{id:"generate-secret-key-form-container"},e?r.createElement(r.Fragment,null,r.createElement("div",{className:"big-spacer-bottom"},r.createElement("h3",{className:"spacer-bottom"},Object(i.translate)("encryption.secret_key")),r.createElement("input",{className:"input-clear input-code input-large",id:"secret-key",readOnly:!0,type:"text",value:e}),r.createElement(p.ClipboardButton,{className:"little-spacer-left",copyValue:e})),r.createElement("h3",{className:"spacer-bottom"},Object(i.translate)("encryption.how_to_use")),r.createElement("div",{className:"markdown"},r.createElement("ul",null,r.createElement("li",null,r.createElement(l.FormattedMessage,{defaultMessage:Object(i.translate)("encryption.how_to_use.content1"),id:"encryption.how_to_use.content1",values:{secret_file:r.createElement("code",null,"~/.sonar/sonar-secret.txt"),property:r.createElement("code",null,"sonar.secretKeyPath"),propreties_file:r.createElement("code",null,"conf/sonar.properties")}})),r.createElement("li",null,Object(i.translate)("encryption.how_to_use.content2")),r.createElement("li",null,r.createElement(l.FormattedMessage,{defaultMessage:Object(i.translate)("encryption.how_to_use.content3"),id:"encryption.how_to_use.content3",values:{property:r.createElement("code",null,"sonar.secretKeyPath")}})),r.createElement("li",null,Object(i.translate)("encryption.how_to_use.content4"))))):r.createElement("form",{id:"generate-secret-key-form",onSubmit:this.handleSubmit},r.createElement("p",{className:"spacer-bottom"},r.createElement(l.FormattedMessage,{defaultMessage:Object(i.translate)("encryption.secret_key_description"),id:"encryption.secret_key_description",values:{moreInformationLink:r.createElement(u.c,{to:"/documentation/instance-administration/security/",target:"_blank"},Object(i.translate)("more_information"))}})),r.createElement(m.SubmitButton,{disabled:t},Object(i.translate)("encryption.generate_secret_key")),r.createElement(c.a,{className:"spacer-left",loading:t})))}}class y extends r.PureComponent{constructor(){super(...arguments),this.state={loading:!0},this.mounted=!1,this.checkSecretKey=()=>{Object(o.a)().then(({secretKeyAvailable:e})=>{this.mounted&&this.setState({loading:!1,secretKeyAvailable:e})},()=>{this.mounted&&this.setState({loading:!1})})},this.generateSecretKey=()=>Object(o.c)().then(({secretKey:e})=>{this.mounted&&this.setState({secretKey:e,secretKeyAvailable:!1})})}componentDidMount(){this.mounted=!0,this.checkSecretKey()}componentWillUnmount(){this.mounted=!1}render(){const{loading:e,secretKey:t,secretKeyAvailable:n}=this.state;return r.createElement("div",{className:"page page-limited",id:"encryption-page"},r.createElement(a.a,{defer:!1,title:Object(i.translate)("property.category.security.encryption")}),r.createElement("header",{className:"page-header"},r.createElement("h1",{className:"page-title"},Object(i.translate)("property.category.security.encryption")),r.createElement(c.a,{loading:e})),!e&&!n&&r.createElement(h,{generateSecretKey:this.generateSecretKey,secretKey:t}),n&&r.createElement(d,{generateSecretKey:this.generateSecretKey}))}}},421:function(e,t,n){var r=n(336),a=n(329),s=n(515),c=n(517);e.exports=function(e,t){if(null==e)return{};var n=r(c(e),(function(e){return[e]}));return t=a(t),s(e,n,(function(e,n){return t(e,n[0])}))}},438:function(e,t,n){var r=n(329),a=n(439),s=n(421);e.exports=function(e,t){return s(e,a(r(t)))}},439:function(e,t){e.exports=function(e){if("function"!=typeof e)throw new TypeError("Expected a function");return function(){var t=arguments;switch(t.length){case 0:return!e.call(this);case 1:return!e.call(this,t[0]);case 2:return!e.call(this,t[0],t[1]);case 3:return!e.call(this,t[0],t[1],t[2])}return!e.apply(this,t)}}},452:function(e,t,n){"use strict";n.d(t,"d",(function(){return o})),n.d(t,"e",(function(){return l})),n.d(t,"h",(function(){return u})),n.d(t,"i",(function(){return m})),n.d(t,"f",(function(){return p})),n.d(t,"g",(function(){return d})),n.d(t,"a",(function(){return h})),n.d(t,"c",(function(){return y})),n.d(t,"b",(function(){return g}));var r=n(438),a=n.n(r),s=n(9),c=n(324),i=n(432);function o(e){return Object(s.getJSON)("/api/settings/list_definitions",{component:e}).then(e=>e.definitions,c.a)}function l(e){return Object(s.getJSON)("/api/settings/values",e).then(e=>e.settings)}function u(e,t,n){const{key:r}=e,c={key:r,component:n};return Object(i.k)(e)&&e.multiValues?c.values=t:"PROPERTY_SET"===e.type?c.fieldValues=t.map(e=>a()(e,e=>null==e)).map(JSON.stringify):c.value=t,Object(s.post)("/api/settings/set",c)}function m(e){return Object(s.post)("/api/settings/set",e).catch(c.a)}function p(e){return Object(s.post)("/api/settings/reset",e)}function d(e,t,n){return Object(s.post)("/api/emails/send",{to:e,subject:t,message:n})}function h(){return Object(s.getJSON)("/api/settings/check_secret_key").catch(c.a)}function y(){return Object(s.postJSON)("/api/settings/generate_secret_key").catch(c.a)}function g(e){return Object(s.postJSON)("/api/settings/encrypt",{value:e}).catch(c.a)}}}]);
//# sourceMappingURL=335.m.0cabdb22.chunk.js.map
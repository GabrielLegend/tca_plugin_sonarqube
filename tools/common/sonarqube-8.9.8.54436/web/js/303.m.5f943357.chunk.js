(window.webpackJsonp=window.webpackJsonp||[]).push([[303],{1747:function(e,t,s){"use strict";(function(e){s.d(t,"a",(function(){return y}));var n=s(2),a=s(316),i=s(318),r=s(312),o=s(331),l=s.n(o),c=s(322),p=s(340),h=s.n(p),d=s(346),m=s.n(d),u=s(31),b=s(375),g=s(955),f=s(321);class y extends n.PureComponent{constructor(e){super(e),this.mounted=!1,this.handleInputChange=e=>{const{name:t,value:s}=e.currentTarget;this.setState({[t]:s})},this.handleVisibilityChange=e=>{this.setState({visibility:e})},this.handleFormSubmit=e=>{e.preventDefault();const t={name:this.state.name,project:this.state.key,visibility:this.state.visibility};this.setState({loading:!0}),Object(b.c)(t).then(e=>{this.mounted&&(this.setState({createdProject:e.project,loading:!1}),this.props.onProjectCreated())},()=>{this.mounted&&this.setState({loading:!1})})},this.state={key:"",loading:!1,name:"",visibility:e.defaultProjectVisibility}}componentDidMount(){this.mounted=!0}componentDidUpdate(){e(()=>{this.closeButton&&this.closeButton.focus()})}componentWillUnmount(){this.mounted=!1}render(){const{defaultProjectVisibility:e}=this.props,{createdProject:t}=this.state;return n.createElement(l.a,{contentLabel:"modal form",onRequestClose:this.props.onClose},t?n.createElement("div",null,n.createElement("header",{className:"modal-head"},n.createElement("h2",null,Object(u.translate)("qualifiers.create.TRK"))),n.createElement("div",{className:"modal-body"},n.createElement(c.Alert,{variant:"success"},n.createElement(a.FormattedMessage,{defaultMessage:Object(u.translate)("projects_management.project_has_been_successfully_created"),id:"projects_management.project_has_been_successfully_created",values:{project:n.createElement(i.c,{to:Object(f.v)(t.key)},t.name)}}))),n.createElement("footer",{className:"modal-foot"},n.createElement(r.ResetButtonLink,{id:"create-project-close",innerRef:e=>this.closeButton=e,onClick:this.props.onClose},Object(u.translate)("close")))):n.createElement("form",{id:"create-project-form",onSubmit:this.handleFormSubmit},n.createElement("header",{className:"modal-head"},n.createElement("h2",null,Object(u.translate)("qualifiers.create.TRK"))),n.createElement("div",{className:"modal-body"},n.createElement(m.a,{className:"modal-field"}),n.createElement("div",{className:"modal-field"},n.createElement("label",{htmlFor:"create-project-name"},Object(u.translate)("name"),n.createElement(h.a,null)),n.createElement("input",{autoFocus:!0,id:"create-project-name",maxLength:2e3,name:"name",onChange:this.handleInputChange,required:!0,type:"text",value:this.state.name})),n.createElement("div",{className:"modal-field"},n.createElement("label",{htmlFor:"create-project-key"},Object(u.translate)("key"),n.createElement(h.a,null)),n.createElement("input",{id:"create-project-key",maxLength:400,name:"key",onChange:this.handleInputChange,required:!0,type:"text",value:this.state.key})),n.createElement("div",{className:"modal-field"},n.createElement("label",null,Object(u.translate)("visibility")),n.createElement(g.a,{canTurnToPrivate:void 0!==e,className:"little-spacer-top",onChange:this.handleVisibilityChange,visibility:this.state.visibility}))),n.createElement("footer",{className:"modal-foot"},this.state.loading&&n.createElement("i",{className:"spinner spacer-right"}),n.createElement(r.SubmitButton,{disabled:this.state.loading,id:"create-project-submit"},Object(u.translate)("create")),n.createElement(r.ResetButtonLink,{id:"create-project-cancel",onClick:this.props.onClose},Object(u.translate)("cancel")))))}}}).call(this,s(1748).setImmediate)},1750:function(e,t,s){var n=s(313),a=s(1751);"string"==typeof(a=a.__esModule?a.default:a)&&(a=[[e.i,a,""]]);var i={insert:"head",singleton:!1},r=(n(a,i),a.locals?a.locals:{});e.exports=r},1751:function(e,t,s){(t=s(314)(!1)).push([e.i,".project-row-text-cell{max-width:20em}",""]),e.exports=t},1852:function(e,t,s){"use strict";s.r(t),s.d(t,"App",(function(){return je}));var n=s(349),a=s.n(n),i=s(457),r=s.n(i),o=s(382),l=s.n(o),c=s(2),p=s(335),h=s(325),d=s(351),m=s.n(d),u=s(26),b=s(31),g=s(375),f=s(497),y=s(452),j=s(341),v=s(353),E=s(327),C=s(673),k=s(569),O=s(1747),P=s(312),_=s(331),S=s.n(_),D=s(398),N=s.n(D),x=s(322);class q extends c.PureComponent{constructor(e){super(e),this.handleConfirmClick=()=>{this.props.onConfirm(this.state.visibility),this.props.onClose()},this.handleVisibilityChange=e=>{this.setState({visibility:e})},this.state={visibility:e.defaultVisibility}}render(){return c.createElement(S.a,{contentLabel:"modal form",onRequestClose:this.props.onClose},c.createElement("header",{className:"modal-head"},c.createElement("h2",null,Object(b.translate)("settings.projects.change_visibility_form.header"))),c.createElement("div",{className:"modal-body"},["public","private"].map(e=>c.createElement("div",{className:"big-spacer-bottom",key:e},c.createElement(N.a,{value:e,checked:this.state.visibility===e,onCheck:this.handleVisibilityChange},c.createElement("div",null,Object(b.translate)("visibility",e),c.createElement("p",{className:"text-muted spacer-top"},Object(b.translate)("visibility",e,"description.short")))))),c.createElement(x.Alert,{variant:"warning"},Object(b.translate)("settings.projects.change_visibility_form.warning"))),c.createElement("footer",{className:"modal-foot"},c.createElement(P.Button,{className:"js-confirm",onClick:this.handleConfirmClick},Object(b.translate)("settings.projects.change_visibility_form.submit")),c.createElement(P.ResetButtonLink,{className:"js-modal-close",onClick:this.props.onClose},Object(b.translate)("cancel"))))}}class w extends c.PureComponent{constructor(){super(...arguments),this.state={visibilityForm:!1},this.handleChangeVisibilityClick=()=>{this.setState({visibilityForm:!0})},this.closeVisiblityForm=()=>{this.setState({visibilityForm:!1})}}render(){const{defaultProjectVisibility:e,hasProvisionPermission:t}=this.props,{visibilityForm:s}=this.state;return c.createElement("header",{className:"page-header"},c.createElement("h1",{className:"page-title"},Object(b.translate)("projects_management")),c.createElement("div",{className:"page-actions"},c.createElement("span",{className:"big-spacer-right"},c.createElement("span",{className:"text-middle"},Object(b.translate)("settings.projects.default_visibility_of_new_projects")," ",c.createElement("strong",null,e?Object(b.translate)("visibility",e):"—")),c.createElement(P.EditButton,{className:"js-change-visibility spacer-left button-small",onClick:this.handleChangeVisibilityClick})),t&&c.createElement(P.Button,{id:"create-project",onClick:this.props.onProjectCreate},Object(b.translate)("qualifiers.create.TRK"))),c.createElement("p",{className:"page-description"},Object(b.translate)("projects_management.page.description")),s&&c.createElement(q,{defaultVisibility:e||"public",onClose:this.closeVisiblityForm,onConfirm:this.props.onChangeDefaultProjectVisibility}))}}var M=s(311),T=s(318),A=s(338),B=s.n(A),F=s(317),R=s.n(F),V=s(345),W=s.n(V),I=s(363),U=s.n(I),z=s(705),L=s(321),J=(s(1750),s(374)),Q=s.n(J),K=s(319),Y=s.n(K),H=s(564),G=s(956),X=s(316);class Z extends c.PureComponent{constructor(){super(...arguments),this.mounted=!1,this.state={loading:!1},this.handleFormSubmit=e=>{e.preventDefault(),this.setState({loading:!0}),Promise.all([this.grantPermission("user"),this.grantPermission("admin")]).then(this.props.onRestoreAccess,()=>{this.mounted&&this.setState({loading:!1})})},this.grantPermission=e=>Object(f.p)({projectKey:this.props.project.key,login:this.props.currentUser.login,permission:e})}componentDidMount(){this.mounted=!0}componentWillUnmount(){this.mounted=!1}render(){const e=Object(b.translate)("global_permissions.restore_access");return c.createElement(S.a,{contentLabel:e,onRequestClose:this.props.onClose},c.createElement("form",{onSubmit:this.handleFormSubmit},c.createElement("header",{className:"modal-head"},c.createElement("h2",null,e)),c.createElement("div",{className:"modal-body"},c.createElement(X.FormattedMessage,{defaultMessage:Object(b.translate)("global_permissions.restore_access.message"),id:"global_permissions.restore_access.message",values:{browse:c.createElement("strong",null,Object(b.translate)("projects_role.user")),administer:c.createElement("strong",null,Object(b.translate)("projects_role.admin"))}})),c.createElement("footer",{className:"modal-foot"},this.state.loading&&c.createElement("i",{className:"spinner spacer-right"}),c.createElement(P.SubmitButton,{disabled:this.state.loading},Object(b.translate)("restore")),c.createElement(P.ResetButtonLink,{onClick:this.props.onClose},Object(b.translate)("cancel")))))}}class $ extends c.PureComponent{constructor(){super(...arguments),this.mounted=!1,this.state={applyTemplateModal:!1,loading:!1,restoreAccessModal:!1},this.fetchPermissions=()=>{this.setState({loading:!0}),Object(H.a)({component:this.props.project.key}).then(({configuration:e})=>{if(this.mounted){const t=Boolean(e&&e.showPermissions&&e.canBrowseProject);this.setState({hasAccess:t,loading:!1})}},()=>{this.mounted&&this.setState({loading:!1})})},this.handleDropdownOpen=()=>{void 0!==this.state.hasAccess||this.state.loading||this.fetchPermissions()},this.handleApplyTemplateClick=()=>{this.setState({applyTemplateModal:!0})},this.handleApplyTemplateClose=()=>{this.mounted&&this.setState({applyTemplateModal:!1})},this.handleRestoreAccessClick=()=>{this.setState({restoreAccessModal:!0})},this.handleRestoreAccessClose=()=>this.setState({restoreAccessModal:!1}),this.handleRestoreAccessDone=()=>{this.setState({hasAccess:!0,restoreAccessModal:!1})}}componentDidMount(){this.mounted=!0}componentWillUnmount(){this.mounted=!1}render(){const{hasAccess:e,loading:t}=this.state;return c.createElement(c.Fragment,null,c.createElement(Q.a,{onOpen:this.handleDropdownOpen},t?c.createElement(J.ActionsDropdownItem,null,c.createElement(Y.a,null)):c.createElement(c.Fragment,null,!0===e&&c.createElement(J.ActionsDropdownItem,{className:"js-edit-permissions",to:Object(L.l)(this.props.project.key)},Object(b.translate)("edit_permissions")),!1===e&&c.createElement(J.ActionsDropdownItem,{className:"js-restore-access",onClick:this.handleRestoreAccessClick},Object(b.translate)("global_permissions.restore_access"))),c.createElement(J.ActionsDropdownItem,{className:"js-apply-template",onClick:this.handleApplyTemplateClick},Object(b.translate)("projects_role.apply_template"))),this.state.restoreAccessModal&&c.createElement(Z,{currentUser:this.props.currentUser,onClose:this.handleRestoreAccessClose,onRestoreAccess:this.handleRestoreAccessDone,project:this.props.project}),this.state.applyTemplateModal&&c.createElement(G.a,{onClose:this.handleApplyTemplateClose,project:this.props.project}))}}class ee extends c.PureComponent{constructor(){super(...arguments),this.handleProjectCheck=e=>{this.props.onProjectCheck(this.props.project,e)}}render(){const{project:e,selected:t}=this.props;return c.createElement("tr",{"data-project-key":e.key},c.createElement("td",{className:"thin"},c.createElement(B.a,{checked:t,onCheck:this.handleProjectCheck})),c.createElement("td",{className:"nowrap hide-overflow project-row-text-cell"},c.createElement(T.c,{className:"link-with-icon",to:Object(L.k)(e.key,e.qualifier)},c.createElement(W.a,{className:"little-spacer-right",qualifier:e.qualifier}),c.createElement(R.a,{overlay:e.name,placement:"left"},c.createElement("span",null,e.name)))),c.createElement("td",{className:"thin nowrap"},c.createElement(z.a,{qualifier:e.qualifier,visibility:e.visibility})),c.createElement("td",{className:"nowrap hide-overflow project-row-text-cell"},c.createElement(R.a,{overlay:e.key,placement:"left"},c.createElement("span",{className:"note"},e.key))),c.createElement("td",{className:"thin nowrap text-right"},e.lastAnalysisDate?c.createElement(U.a,{date:e.lastAnalysisDate}):c.createElement("span",{className:"note"},"—")),c.createElement("td",{className:"thin nowrap"},c.createElement($,{currentUser:this.props.currentUser,project:e})))}}class te extends c.PureComponent{constructor(){super(...arguments),this.onProjectCheck=(e,t)=>{t?this.props.onProjectSelected(e.key):this.props.onProjectDeselected(e.key)}}render(){return c.createElement("div",{className:"boxed-group boxed-group-inner"},c.createElement("table",{className:M("data","zebra",{"new-loading":!this.props.ready}),id:"projects-management-page-projects"},c.createElement("thead",null,c.createElement("tr",null,c.createElement("th",null),c.createElement("th",null,Object(b.translate)("name")),c.createElement("th",null),c.createElement("th",null,Object(b.translate)("key")),c.createElement("th",{className:"thin nowrap text-right"},Object(b.translate)("last_analysis")),c.createElement("th",null))),c.createElement("tbody",null,this.props.projects.map(e=>c.createElement(ee,{currentUser:this.props.currentUser,key:e.key,onProjectCheck:this.onProjectCheck,project:e,selected:this.props.selection.includes(e.key)})))))}}var se=s(330),ne=s.n(se),ae=s(323),ie=s.n(ae),re=s(355),oe=s.n(re),le=s(348),ce=s.n(le),pe=s(537),he=s(340),de=s.n(he),me=s(346),ue=s.n(me);class be extends c.PureComponent{constructor(){super(...arguments),this.mounted=!1,this.state={done:!1,loading:!0,submitting:!1},this.handleConfirmClick=()=>{const{analyzedBefore:e}=this.props,{permissionTemplate:t}=this.state;if(t){this.setState({submitting:!0});const s=this.props.selection.length?{projects:this.props.selection.join(),qualifiers:this.props.qualifier,templateId:t}:{analyzedBefore:e&&Object(u.toNotSoISOString)(e),onProvisionedOnly:this.props.provisioned||void 0,qualifiers:this.props.qualifier,q:this.props.query||void 0,templateId:t};Object(f.c)(s).then(()=>{this.mounted&&this.setState({done:!0,submitting:!1})},()=>{this.mounted&&this.setState({submitting:!1})})}},this.handlePermissionTemplateChange=({value:e})=>{this.setState({permissionTemplate:e})},this.renderWarning=()=>c.createElement(x.Alert,{variant:"warning"},this.props.selection.length?Object(b.translateWithParameters)("permission_templates.bulk_apply_permission_template.apply_to_selected",this.props.selection.length):Object(b.translateWithParameters)("permission_templates.bulk_apply_permission_template.apply_to_all",this.props.total)),this.renderSelect=()=>c.createElement("div",{className:"modal-field"},c.createElement("label",null,Object(b.translate)("template"),c.createElement(de.a,null)),c.createElement(ce.a,{clearable:!1,disabled:this.state.submitting,onChange:this.handlePermissionTemplateChange,options:this.state.permissionTemplates.map(e=>({label:e.name,value:e.id})),value:this.state.permissionTemplate}))}componentDidMount(){this.mounted=!0,this.loadPermissionTemplates()}componentWillUnmount(){this.mounted=!1}loadPermissionTemplates(){this.setState({loading:!0}),Object(f.l)().then(({permissionTemplates:e})=>{this.mounted&&this.setState({loading:!1,permissionTemplate:e.length>0?e[0].id:void 0,permissionTemplates:e})},()=>{this.mounted&&this.setState({loading:!1})})}render(){const{done:e,loading:t,permissionTemplates:s,submitting:n}=this.state,a=Object(b.translate)("permission_templates.bulk_apply_permission_template");return c.createElement(S.a,{contentLabel:a,onRequestClose:this.props.onClose,size:"small"},c.createElement("header",{className:"modal-head"},c.createElement("h2",null,a)),c.createElement("div",{className:"modal-body"},e&&c.createElement(x.Alert,{variant:"success"},Object(b.translate)("projects_role.apply_template.success")),t&&c.createElement("i",{className:"spinner"}),!t&&!e&&s&&c.createElement(c.Fragment,null,c.createElement(ue.a,{className:"spacer-bottom"}),this.renderWarning(),this.renderSelect())),c.createElement("footer",{className:"modal-foot"},n&&c.createElement("i",{className:"spinner spacer-right"}),!t&&!e&&s&&c.createElement(P.SubmitButton,{disabled:n,onClick:this.handleConfirmClick},Object(b.translate)("apply")),c.createElement(P.ResetButtonLink,{onClick:this.props.onClose},e?Object(b.translate)("close"):Object(b.translate)("cancel"))))}}class ge extends c.PureComponent{constructor(){super(...arguments),this.mounted=!1,this.state={loading:!1},this.handleConfirmClick=()=>{this.setState({loading:!0});const{analyzedBefore:e}=this.props,t=this.props.selection.length?{projects:this.props.selection.join()}:{analyzedBefore:e&&Object(u.toNotSoISOString)(e),onProvisionedOnly:this.props.provisioned||void 0,qualifiers:this.props.qualifier,q:this.props.query||void 0};Object(g.a)(t).then(()=>{this.mounted&&this.props.onConfirm()},()=>{this.mounted&&this.setState({loading:!1})})},this.renderWarning=()=>c.createElement(x.Alert,{variant:"warning"},this.props.selection.length?Object(b.translateWithParameters)("projects_management.delete_selected_warning",this.props.selection.length):Object(b.translateWithParameters)("projects_management.delete_all_warning",this.props.total))}componentDidMount(){this.mounted=!0}componentWillUnmount(){this.mounted=!1}render(){const e=Object(b.translate)("qualifiers.delete",this.props.qualifier);return c.createElement(S.a,{contentLabel:e,onRequestClose:this.props.onClose},c.createElement("header",{className:"modal-head"},c.createElement("h2",null,e)),c.createElement("div",{className:"modal-body"},this.renderWarning(),Object(b.translate)("qualifiers.delete_confirm",this.props.qualifier)),c.createElement("footer",{className:"modal-foot"},this.state.loading&&c.createElement("i",{className:"spinner spacer-right"}),c.createElement(P.SubmitButton,{className:"button-red",disabled:this.state.loading,onClick:this.handleConfirmClick},Object(b.translate)("delete")),c.createElement(P.ResetButtonLink,{onClick:this.props.onClose},Object(b.translate)("cancel"))))}}const fe=["TRK","VW","APP"];class ye extends c.PureComponent{constructor(){super(...arguments),this.mounted=!1,this.state={bulkApplyTemplateModal:!1,deleteModal:!1},this.getQualifierOptions=()=>{const e=this.props.topLevelQualifiers.map(e=>({label:Object(b.translate)("qualifiers",e),value:e}));return ne()(e,e=>fe.indexOf(e.value))},this.onCheck=e=>{e?this.props.onAllSelected():this.props.onAllDeselected()},this.handleDeleteClick=()=>{this.setState({deleteModal:!0})},this.closeDeleteModal=()=>{this.setState({deleteModal:!1})},this.handleDeleteConfirm=()=>{this.closeDeleteModal(),this.props.onDeleteProjects()},this.handleBulkApplyTemplateClick=()=>{this.setState({bulkApplyTemplateModal:!0})},this.closeBulkApplyTemplateModal=()=>{this.setState({bulkApplyTemplateModal:!1})},this.handleQualifierChange=({value:e})=>this.props.onQualifierChanged(e),this.handleVisibilityChange=({value:e})=>this.props.onVisibilityChanged(e),this.renderCheckbox=()=>{const e=this.props.projects.length>0&&this.props.selection.length===this.props.projects.length,t=this.props.projects.length>0&&this.props.selection.length>0&&this.props.selection.length<this.props.projects.length,s=e||t;return c.createElement(B.a,{checked:s,id:"projects-selection",onCheck:this.onCheck,thirdState:t})},this.renderQualifierOption=e=>c.createElement("span",null,c.createElement(W.a,{className:"little-spacer-right",qualifier:e.value}),e.label),this.renderQualifierFilter=()=>this.getQualifierOptions().length<2?null:c.createElement("td",{className:"thin nowrap text-middle"},c.createElement(ce.a,{className:"input-medium",clearable:!1,disabled:!this.props.ready,name:"projects-qualifier",onChange:this.handleQualifierChange,optionRenderer:this.renderQualifierOption,options:this.getQualifierOptions(),searchable:!1,value:this.props.qualifiers,valueRenderer:this.renderQualifierOption})),this.renderVisibilityFilter=()=>c.createElement("td",{className:"thin nowrap text-middle"},c.createElement(ce.a,{className:"input-small",clearable:!1,disabled:!this.props.ready,name:"projects-visibility",onChange:this.handleVisibilityChange,options:[{value:"all",label:Object(b.translate)("visibility.both")},{value:"public",label:Object(b.translate)("visibility.public")},{value:"private",label:Object(b.translate)("visibility.private")}],searchable:!1,value:this.props.visibility||"all"})),this.renderTypeFilter=()=>"TRK"===this.props.qualifiers?c.createElement("td",{className:"thin nowrap text-middle"},c.createElement(B.a,{checked:this.props.provisioned,className:"link-checkbox-control",id:"projects-provisioned",onCheck:this.props.onProvisionedChanged},c.createElement("span",{className:"text-middle little-spacer-left"},Object(b.translate)("provisioning.only_provisioned"))),c.createElement(ie.a,{className:"spacer-left",overlay:Object(b.translate)("provisioning.only_provisioned.tooltip")})):null,this.renderDateFilter=()=>c.createElement("td",{className:"thin nowrap text-middle"},c.createElement(pe.a,{inputClassName:"input-medium",name:"analyzed-before",onChange:this.props.onDateChanged,placeholder:Object(b.translate)("last_analysis_before"),value:this.props.analyzedBefore}))}render(){return c.createElement("div",{className:"big-spacer-bottom"},c.createElement("table",{className:"data"},c.createElement("tbody",null,c.createElement("tr",null,c.createElement("td",{className:"thin text-middle"},this.props.ready?this.renderCheckbox():c.createElement("i",{className:"spinner"})),this.renderQualifierFilter(),this.renderDateFilter(),this.renderVisibilityFilter(),this.renderTypeFilter(),c.createElement("td",{className:"text-middle"},c.createElement(oe.a,{minLength:3,onChange:this.props.onSearch,placeholder:Object(b.translate)("search.search_by_name_or_key"),value:this.props.query})),c.createElement("td",{className:"thin nowrap text-middle"},c.createElement(P.Button,{className:"js-bulk-apply-permission-template",disabled:0===this.props.selection.length,onClick:this.handleBulkApplyTemplateClick},Object(b.translate)("permission_templates.bulk_apply_permission_template")),"TRK"===this.props.qualifiers&&c.createElement(P.Button,{className:"js-delete spacer-left button-red",disabled:0===this.props.selection.length,onClick:this.handleDeleteClick,title:0===this.props.selection.length?Object(b.translate)("permission_templates.select_to_delete"):Object(b.translate)("permission_templates.delete_selected")},Object(b.translate)("delete")))))),this.state.bulkApplyTemplateModal&&c.createElement(be,{analyzedBefore:this.props.analyzedBefore,onClose:this.closeBulkApplyTemplateModal,provisioned:this.props.provisioned,qualifier:this.props.qualifiers,query:this.props.query,selection:this.props.selection,total:this.props.total}),this.state.deleteModal&&c.createElement(ge,{analyzedBefore:this.props.analyzedBefore,onClose:this.closeDeleteModal,onConfirm:this.handleDeleteConfirm,provisioned:this.props.provisioned,qualifier:this.props.qualifiers,query:this.props.query,selection:this.props.selection,total:this.props.total}))}}class je extends c.PureComponent{constructor(e){super(e),this.mounted=!1,this.fetchDefaultProjectVisibility=async()=>{const e=await Object(y.e)({keys:k.a.DefaultProjectVisibility});this.mounted&&e.length>0&&e[0].value&&this.setState({defaultProjectVisibility:e[0].value})},this.handleDefaultProjectVisibilityChange=async e=>{await Object(f.d)(e),this.mounted&&this.setState({defaultProjectVisibility:e})},this.requestProjects=()=>{const{analyzedBefore:e}=this.state,t={analyzedBefore:e&&Object(u.toShortNotSoISOString)(e),onProvisionedOnly:this.state.provisioned||void 0,p:1!==this.state.page?this.state.page:void 0,ps:50,q:this.state.query||void 0,qualifiers:this.state.qualifiers,visibility:this.state.visibility};return Object(g.o)(t).then(e=>{if(this.mounted){let t=e.components;this.state.page>1&&(t=[...this.state.projects,...t]),this.setState({ready:!0,projects:t,selection:[],total:e.paging.total})}})},this.loadMore=()=>{this.setState(({page:e})=>({ready:!1,page:e+1}),this.requestProjects)},this.onSearch=e=>{this.setState({ready:!1,page:1,query:e,selection:[]},this.requestProjects)},this.onProvisionedChanged=e=>{this.setState({ready:!1,page:1,query:"",provisioned:e,qualifiers:"TRK",selection:[]},this.requestProjects)},this.onQualifierChanged=e=>{this.setState({ready:!1,page:1,provisioned:!1,query:"",qualifiers:e,selection:[]},this.requestProjects)},this.onVisibilityChanged=e=>{this.setState({ready:!1,page:1,provisioned:!1,query:"",visibility:"all"===e?void 0:e,selection:[]},this.requestProjects)},this.handleDateChanged=e=>this.setState({ready:!1,page:1,analyzedBefore:e},this.requestProjects),this.onProjectSelected=e=>{this.setState(({selection:t})=>({selection:r()([...t,e])}))},this.onProjectDeselected=e=>{this.setState(({selection:t})=>({selection:a()(t,e)}))},this.onAllSelected=()=>{this.setState(({projects:e})=>({selection:e.map(e=>e.key)}))},this.onAllDeselected=()=>{this.setState({selection:[]})},this.openCreateProjectForm=()=>{this.setState({createProjectForm:!0})},this.closeCreateProjectForm=()=>{this.setState({createProjectForm:!1})},this.state={createProjectForm:!1,ready:!1,projects:[],provisioned:!1,total:0,page:1,query:"",qualifiers:"TRK",selection:[]},this.requestProjects=l()(this.requestProjects,250)}componentDidMount(){this.mounted=!0,this.requestProjects(),this.fetchDefaultProjectVisibility()}componentWillUnmount(){this.mounted=!1}render(){const{appState:e,currentUser:t}=this.props,{defaultProjectVisibility:s}=this.state;return c.createElement("div",{className:"page page-limited",id:"projects-management-page"},c.createElement(j.a,{suggestions:"projects_management"}),c.createElement(p.a,{defer:!1,title:Object(b.translate)("projects_management")}),c.createElement(w,{defaultProjectVisibility:s,hasProvisionPermission:Object(v.a)(t,C.a.ProjectCreation),onChangeDefaultProjectVisibility:this.handleDefaultProjectVisibilityChange,onProjectCreate:this.openCreateProjectForm}),c.createElement(ye,{analyzedBefore:this.state.analyzedBefore,onAllDeselected:this.onAllDeselected,onAllSelected:this.onAllSelected,onDateChanged:this.handleDateChanged,onDeleteProjects:this.requestProjects,onProvisionedChanged:this.onProvisionedChanged,onQualifierChanged:this.onQualifierChanged,onSearch:this.onSearch,onVisibilityChanged:this.onVisibilityChanged,projects:this.state.projects,provisioned:this.state.provisioned,qualifiers:this.state.qualifiers,query:this.state.query,ready:this.state.ready,selection:this.state.selection,topLevelQualifiers:e.qualifiers,total:this.state.total,visibility:this.state.visibility}),c.createElement(te,{currentUser:this.props.currentUser,onProjectDeselected:this.onProjectDeselected,onProjectSelected:this.onProjectSelected,projects:this.state.projects,ready:this.state.ready,selection:this.state.selection}),c.createElement(m.a,{count:this.state.projects.length,loadMore:this.loadMore,ready:this.state.ready,total:this.state.total}),this.state.createProjectForm&&c.createElement(O.a,{defaultProjectVisibility:s,onClose:this.closeCreateProjectForm,onProjectCreated:this.requestProjects}))}}t.default=Object(h.b)(e=>({appState:Object(E.getAppState)(e),currentUser:Object(E.getCurrentUser)(e)}))(je)},341:function(e,t,s){"use strict";s.d(t,"a",(function(){return i}));var n=s(2),a=s(379);function i({suggestions:e}){return n.createElement(a.a.Consumer,null,({addSuggestions:t,removeSuggestions:s})=>n.createElement(r,{addSuggestions:t,removeSuggestions:s,suggestions:e}))}class r extends n.PureComponent{componentDidMount(){this.props.addSuggestions(this.props.suggestions)}componentDidUpdate(e){e.suggestions!==this.props.suggestions&&(this.props.removeSuggestions(this.props.suggestions),this.props.addSuggestions(e.suggestions))}componentWillUnmount(){this.props.removeSuggestions(this.props.suggestions)}render(){return null}}},452:function(e,t,s){"use strict";s.d(t,"d",(function(){return l})),s.d(t,"e",(function(){return c})),s.d(t,"h",(function(){return p})),s.d(t,"i",(function(){return h})),s.d(t,"f",(function(){return d})),s.d(t,"g",(function(){return m})),s.d(t,"a",(function(){return u})),s.d(t,"c",(function(){return b})),s.d(t,"b",(function(){return g}));var n=s(438),a=s.n(n),i=s(9),r=s(324),o=s(432);function l(e){return Object(i.getJSON)("/api/settings/list_definitions",{component:e}).then(e=>e.definitions,r.a)}function c(e){return Object(i.getJSON)("/api/settings/values",e).then(e=>e.settings)}function p(e,t,s){const{key:n}=e,r={key:n,component:s};return Object(o.k)(e)&&e.multiValues?r.values=t:"PROPERTY_SET"===e.type?r.fieldValues=t.map(e=>a()(e,e=>null==e)).map(JSON.stringify):r.value=t,Object(i.post)("/api/settings/set",r)}function h(e){return Object(i.post)("/api/settings/set",e).catch(r.a)}function d(e){return Object(i.post)("/api/settings/reset",e)}function m(e,t,s){return Object(i.post)("/api/emails/send",{to:e,subject:t,message:s})}function u(){return Object(i.getJSON)("/api/settings/check_secret_key").catch(r.a)}function b(){return Object(i.postJSON)("/api/settings/generate_secret_key").catch(r.a)}function g(e){return Object(i.postJSON)("/api/settings/encrypt",{value:e}).catch(r.a)}},497:function(e,t,s){"use strict";s.d(t,"p",(function(){return i})),s.d(t,"u",(function(){return r})),s.d(t,"o",(function(){return o})),s.d(t,"t",(function(){return l})),s.d(t,"l",(function(){return c})),s.d(t,"f",(function(){return p})),s.d(t,"y",(function(){return h})),s.d(t,"g",(function(){return d})),s.d(t,"x",(function(){return m})),s.d(t,"b",(function(){return u})),s.d(t,"c",(function(){return b})),s.d(t,"r",(function(){return g})),s.d(t,"w",(function(){return f})),s.d(t,"q",(function(){return y})),s.d(t,"v",(function(){return j})),s.d(t,"a",(function(){return v})),s.d(t,"s",(function(){return E})),s.d(t,"n",(function(){return C})),s.d(t,"m",(function(){return k})),s.d(t,"i",(function(){return O})),s.d(t,"h",(function(){return P})),s.d(t,"k",(function(){return _})),s.d(t,"j",(function(){return S})),s.d(t,"e",(function(){return D})),s.d(t,"d",(function(){return N}));var n=s(9),a=s(324);function i(e){return Object(n.post)("/api/permissions/add_user",e).catch(a.a)}function r(e){return Object(n.post)("/api/permissions/remove_user",e).catch(a.a)}function o(e){return Object(n.post)("/api/permissions/add_group",e).catch(a.a)}function l(e){return Object(n.post)("/api/permissions/remove_group",e).catch(a.a)}function c(){return Object(n.getJSON)("/api/permissions/search_templates")}function p(e){return Object(n.postJSON)("/api/permissions/create_template",e)}function h(e){return Object(n.post)("/api/permissions/update_template",e)}function d(e){return Object(n.post)("/api/permissions/delete_template",e).catch(a.a)}function m(e,t){return Object(n.post)("/api/permissions/set_default_template",{templateId:e,qualifier:t})}function u(e){return Object(n.post)("/api/permissions/apply_template",e).catch(a.a)}function b(e){return Object(n.post)("/api/permissions/bulk_apply_template",e)}function g(e){return Object(n.post)("/api/permissions/add_user_to_template",e)}function f(e){return Object(n.post)("/api/permissions/remove_user_from_template",e)}function y(e){return Object(n.post)("/api/permissions/add_group_to_template",e)}function j(e){return Object(n.post)("/api/permissions/remove_group_from_template",e)}function v(e,t){return Object(n.post)("/api/permissions/add_project_creator_to_template",{templateId:e,permission:t})}function E(e,t){return Object(n.post)("/api/permissions/remove_project_creator_from_template",{templateId:e,permission:t})}function C(e){return e.ps||(e.ps=100),Object(n.getJSON)("/api/permissions/users",e).catch(a.a)}function k(e){return e.ps||(e.ps=100),Object(n.getJSON)("/api/permissions/groups",e).catch(a.a)}function O(e){return e.ps||(e.ps=100),Object(n.getJSON)("/api/permissions/users",e)}function P(e){return e.ps||(e.ps=100),Object(n.getJSON)("/api/permissions/groups",e)}function _(e,t,s){const a={templateId:e,ps:100};return t&&(a.q=t),s&&(a.permission=s),Object(n.getJSON)("/api/permissions/template_users",a).then(e=>e.users)}function S(e,t,s){const a={templateId:e,ps:100};return t&&(a.q=t),s&&(a.permission=s),Object(n.getJSON)("/api/permissions/template_groups",a).then(e=>e.groups)}function D(e,t){return Object(n.post)("/api/projects/update_visibility",{project:e,visibility:t}).catch(a.a)}function N(e){return Object(n.post)("/api/projects/update_default_visibility",{projectVisibility:e}).catch(a.a)}},537:function(e,t,s){"use strict";s.d(t,"a",(function(){return S}));var n=s(504),a=s.n(n),i=s(311),r=s(444),o=s(519),l=s(534),c=s(535),p=s(2),h=s(316),d=s(312),m=s(547),u=s.n(m),b=s(348),g=s.n(b),f=s(538),y=s.n(f),j=s(510),v=s.n(j),E=s(448),C=s.n(E),k=s(333),O=s(31);s(539),s(541);function P(e,t){if(null==e)return{};var s,n,a=function(e,t){if(null==e)return{};var s,n,a={},i=Object.keys(e);for(n=0;n<i.length;n++)s=i[n],t.indexOf(s)>=0||(a[s]=e[s]);return a}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)s=i[n],t.indexOf(s)>=0||Object.prototype.propertyIsEnumerable.call(e,s)&&(a[s]=e[s])}return a}const _=Object(k.lazyLoadComponent)(()=>s.e(305).then(s.t.bind(null,689,7)),"DayPicker");class S extends p.PureComponent{constructor(e){super(e),this.focus=()=>{this.input&&this.input.focus(),this.openCalendar()},this.handleResetClick=()=>{this.closeCalendar(),this.props.onChange(void 0)},this.openCalendar=()=>{this.setState({currentMonth:this.props.value||this.props.currentMonth||new Date,lastHovered:void 0,open:!0})},this.closeCalendar=()=>{this.setState({open:!1})},this.handleDayClick=(e,t)=>{t.disabled||(this.closeCalendar(),this.props.onChange(e))},this.handleDayMouseEnter=(e,t)=>{this.setState({lastHovered:t.disabled?void 0:e})},this.handleCurrentMonthChange=({value:e})=>{this.setState(t=>({currentMonth:o(t.currentMonth,e)}))},this.handleCurrentYearChange=({value:e})=>{this.setState(t=>({currentMonth:l(t.currentMonth,e)}))},this.handlePreviousMonthClick=()=>{this.setState(e=>({currentMonth:c(e.currentMonth,1)}))},this.handleNextMonthClick=()=>{this.setState(e=>({currentMonth:r(e.currentMonth,1)}))},this.state={currentMonth:e.value||e.currentMonth||new Date,open:!1}}render(){const{highlightFrom:e,highlightTo:t,minDate:s,value:n}=this.props,{lastHovered:r}=this.state,o=this.props.maxDate||new Date,l=a()(12),c=a()((new Date).getFullYear()-10,(new Date).getFullYear()+1),h=n?[n]:[];let m;const b=r||n;e&&b&&(m={highlighted:{from:e,to:b}},h.push(e)),t&&b&&(m={highlighted:{from:b,to:t}},h.push(t));const f=a()(7).map(O.getWeekDayName),j=a()(7).map(O.getShortWeekDayName);return p.createElement(u.a,{onClickOutside:this.closeCalendar},p.createElement("span",{className:i("date-input-control",this.props.className)},p.createElement(N,{className:i("date-input-control-input",this.props.inputClassName,{"is-filled":void 0!==this.props.value}),innerRef:e=>this.input=e,name:this.props.name,onFocus:this.openCalendar,placeholder:this.props.placeholder,readOnly:!0,type:"text",value:n}),p.createElement(y.a,{className:"date-input-control-icon",fill:""}),void 0!==this.props.value&&p.createElement(d.ClearButton,{className:"button-tiny date-input-control-reset",iconProps:{size:12},onClick:this.handleResetClick}),this.state.open&&p.createElement("div",{className:"date-input-calendar"},p.createElement("nav",{className:"date-input-calendar-nav"},p.createElement(d.ButtonIcon,{className:"button-small",onClick:this.handlePreviousMonthClick},p.createElement(v.a,null)),p.createElement("div",{className:"date-input-calender-month"},p.createElement(g.a,{className:"date-input-calender-month-select",onChange:this.handleCurrentMonthChange,options:l.map(e=>({label:Object(O.getShortMonthName)(e),value:e})),value:this.state.currentMonth.getMonth()}),p.createElement(g.a,{className:"date-input-calender-month-select spacer-left",onChange:this.handleCurrentYearChange,options:c.map(e=>({label:String(e),value:e})),value:this.state.currentMonth.getFullYear()})),p.createElement(d.ButtonIcon,{className:"button-small",onClick:this.handleNextMonthClick},p.createElement(C.a,null))),p.createElement(_,{captionElement:p.createElement(D,null),disabledDays:{after:o,before:s},firstDayOfWeek:1,modifiers:m,month:this.state.currentMonth,navbarElement:p.createElement(D,null),onDayClick:this.handleDayClick,onDayMouseEnter:this.handleDayMouseEnter,selectedDays:h,weekdaysLong:f,weekdaysShort:j}))))}}function D(){return null}const N=Object(h.injectIntl)(e=>{let{innerRef:t,intl:s,value:n}=e,a=P(e,["innerRef","intl","value"]);const i=n&&s.formatDate(n,{year:"numeric",month:"short",day:"numeric"});return p.createElement("input",Object.assign({},a,{ref:t,value:i||""}))})},539:function(e,t,s){var n=s(313),a=s(540);"string"==typeof(a=a.__esModule?a.default:a)&&(a=[[e.i,a,""]]);var i={insert:"head",singleton:!1},r=(n(a,i),a.locals?a.locals:{});e.exports=r},540:function(e,t,s){(t=s(314)(!1)).push([e.i,".DayPicker{display:inline-block}.DayPicker-wrapper{position:relative;-webkit-user-select:none;-ms-user-select:none;user-select:none;padding-bottom:8px;flex-direction:row}.DayPicker-Months{display:flex;flex-wrap:wrap;justify-content:center}.DayPicker-Month{display:table;border-collapse:collapse;border-spacing:0;-webkit-user-select:none;-ms-user-select:none;user-select:none;margin:8px 8px 0}.DayPicker-Weekdays{display:table-header-group}.DayPicker-WeekdaysRow{display:table-row}.DayPicker-Weekday{display:table-cell;padding:8px;font-size:12px;text-align:center;color:#999}.DayPicker-Weekday abbr[title]{border-bottom:none;text-decoration:none}.DayPicker-Body{display:table-row-group}.DayPicker-Week{display:table-row}.DayPicker-Day{display:table-cell;line-height:15px;padding:8px;text-align:center;cursor:pointer;vertical-align:top;outline:none}.DayPicker--interactionDisabled .DayPicker-Day{cursor:default}.DayPicker-Footer{padding-top:8px}.DayPicker-Day--today{font-weight:700}.DayPicker-Day--outside{cursor:default;color:#8b9898}.DayPicker-Day--disabled{color:#cdcdcd;cursor:not-allowed}.DayPicker-Day--sunday{background-color:#f7f8f8}.DayPicker-Day--sunday:not(.DayPicker-Day--today){color:#dce0e0}.DayPicker-Day--selected:not(.DayPicker-Day--disabled):not(.DayPicker-Day--outside){background-color:#4b9fd5;color:#fff}.DayPicker:not(.DayPicker--interactionDisabled) .DayPicker-Day:not(.DayPicker-Day--disabled):not(.DayPicker-Day--selected):not(.DayPicker-Day--highlighted):not(.DayPicker-Day--outside):hover{background-color:#f3f3f3}.DayPicker-Day--highlighted:not(.DayPicker-Day--disabled):not(.DayPicker-Day--selected):not(.DayPicker-Day--outside){background-color:#cae3f2}",""]),e.exports=t},541:function(e,t,s){var n=s(313),a=s(542);"string"==typeof(a=a.__esModule?a.default:a)&&(a=[[e.i,a,""]]);var i={insert:"head",singleton:!1},r=(n(a,i),a.locals?a.locals:{});e.exports=r},542:function(e,t,s){(t=s(314)(!1)).push([e.i,".date-input-control{position:relative;display:inline-block;cursor:pointer}.date-input-control-input{width:130px;padding-left:24px!important;cursor:pointer}.date-input-control-input.is-filled{padding-right:16px!important}.date-input-control-icon{position:absolute;top:4px;left:4px}.date-input-control-icon path{fill:#cdcdcd;transition:fill .3s ease}.date-input-control-input:focus+.date-input-control-icon path{fill:#4b9fd5}.date-input-control-reset{position:absolute;top:4px;right:4px;border:none}.date-input-calendar{position:absolute;z-index:7500;top:100%;left:0;border:1px solid #e6e6e6;background-color:#fff;box-shadow:0 6px 12px rgba(0,0,0,.175)}.date-input-calendar-nav{display:flex;justify-content:space-between;align-items:center;padding-top:8px;padding-left:8px;padding-right:8px}.date-input-calender-month-select{width:70px}",""]),e.exports=t},564:function(e,t,s){"use strict";s.d(t,"a",(function(){return i})),s.d(t,"b",(function(){return r})),s.d(t,"c",(function(){return o}));var n=s(9),a=s(324);function i(e){return Object(n.getJSON)("/api/navigation/component",e).catch(a.a)}function r(){return Object(n.getJSON)("/api/navigation/marketplace").catch(a.a)}function o(){return Object(n.getJSON)("/api/navigation/settings").catch(a.a)}},569:function(e,t,s){"use strict";var n;s.d(t,"a",(function(){return n})),function(e){e.DaysBeforeDeletingInactiveBranchesAndPRs="sonar.dbcleaner.daysBeforeDeletingInactiveBranchesAndPRs",e.DefaultProjectVisibility="projects.default.visibility",e.ServerBaseUrl="sonar.core.serverBaseURL",e.PluginRiskConsent="sonar.plugins.risk.consent"}(n||(n={}))},705:function(e,t,s){"use strict";s.d(t,"a",(function(){return l}));var n=s(311),a=s(2),i=s(317),r=s.n(i),o=s(31);function l({className:e,qualifier:t,visibility:s}){return"private"!==s?null:a.createElement(r.a,{overlay:Object(o.translate)("visibility",s,"description",t)},a.createElement("div",{className:n("badge",e)},Object(o.translate)("visibility",s)))}},955:function(e,t,s){"use strict";s.d(t,"a",(function(){return l}));var n=s(311),a=s(2),i=s(398),r=s.n(i),o=s(31);class l extends a.PureComponent{render(){return a.createElement("div",{className:n(this.props.className)},["public","private"].map(e=>a.createElement(r.a,{className:"huge-spacer-right visibility-".concat(e),key:e,value:e,checked:this.props.visibility===e,onCheck:this.props.onChange,disabled:"private"===e&&!this.props.canTurnToPrivate},a.createElement("div",null,Object(o.translate)("visibility",e),this.props.showDetails&&a.createElement("p",{className:"note"},Object(o.translate)("visibility",e,"description.long"))))))}}},956:function(e,t,s){"use strict";s.d(t,"a",(function(){return y}));var n=s(2),a=s(312),i=s(348),r=s.n(i),o=s(332),l=s.n(o),c=s(322),p=s(319),h=s.n(p),d=s(340),m=s.n(d),u=s(346),b=s.n(u),g=s(31),f=s(497);class y extends n.PureComponent{constructor(){super(...arguments),this.mounted=!1,this.state={done:!1,loading:!0},this.fetchPermissionTemplates=()=>{Object(f.l)().then(({permissionTemplates:e})=>{this.mounted&&this.setState({loading:!1,permissionTemplates:e})},()=>{this.mounted&&this.setState({loading:!1})})},this.handleSubmit=()=>this.state.permissionTemplate?Object(f.b)({projectKey:this.props.project.key,templateId:this.state.permissionTemplate}).then(()=>{this.mounted&&(this.props.onApply&&this.props.onApply(),this.setState({done:!0}))}):Promise.reject(void 0),this.handlePermissionTemplateChange=({value:e})=>{this.setState({permissionTemplate:e})}}componentDidMount(){this.mounted=!0,this.fetchPermissionTemplates()}componentWillUnmount(){this.mounted=!1}render(){const e=Object(g.translateWithParameters)("projects_role.apply_template_to_xxx",this.props.project.name);return n.createElement(l.a,{header:e,onClose:this.props.onClose,onSubmit:this.handleSubmit,size:"small"},({onCloseClick:t,onFormSubmit:s,submitting:i})=>n.createElement("form",{id:"project-permissions-apply-template-form",onSubmit:s},n.createElement("header",{className:"modal-head"},n.createElement("h2",null,e)),n.createElement("div",{className:"modal-body"},this.state.done&&n.createElement(c.Alert,{variant:"success"},Object(g.translate)("projects_role.apply_template.success")),this.state.loading&&n.createElement("i",{className:"spinner"}),!this.state.done&&!this.state.loading&&n.createElement(n.Fragment,null,n.createElement(b.a,{className:"modal-field"}),n.createElement("div",{className:"modal-field"},n.createElement("label",{htmlFor:"project-permissions-template"},Object(g.translate)("template"),n.createElement(m.a,null)),this.state.permissionTemplates&&n.createElement(r.a,{clearable:!1,id:"project-permissions-template",onChange:this.handlePermissionTemplateChange,options:this.state.permissionTemplates.map(e=>({label:e.name,value:e.id})),value:this.state.permissionTemplate})))),n.createElement("footer",{className:"modal-foot"},n.createElement(h.a,{className:"spacer-right",loading:i}),!this.state.done&&n.createElement(a.SubmitButton,{disabled:i||!this.state.permissionTemplate},Object(g.translate)("apply")),n.createElement(a.ResetButtonLink,{onClick:t},Object(g.translate)(this.state.done?"close":"cancel")))))}}}}]);
//# sourceMappingURL=303.m.5f943357.chunk.js.map
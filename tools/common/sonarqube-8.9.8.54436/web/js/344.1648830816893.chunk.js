(window.webpackJsonp=window.webpackJsonp||[]).push([[344],{2200:function(e,t,n){"use strict";n.r(t);var a,r=n(13),o=n(176),c=n(898),i=n(785),s=n(661),l=n(755),p=n.n(l),u=n(701),h=n.n(u),d=n(723),f=n.n(d),m=n(742),b=n.n(m),y=n(1777),v=n.n(y),j=n(681),g=n.n(j),E=n(668),O=n.n(E),_=n(688),w=n.n(_),C=n(695),P=n.n(C),k=n(939),S=n.n(k),N=n(689),B=n.n(N),x=n(697),U=n.n(x),A=n(666),M=n.n(A),F=n(694),R=n.n(F),D=n(973),T=(a=function(e,t){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}a(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),L=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.handleMouseDown=function(e){e.preventDefault(),e.stopPropagation(),t.props.onSelect(t.props.option,e)},t.handleMouseEnter=function(e){t.props.onFocus(t.props.option,e)},t.handleMouseMove=function(e){t.props.isFocused||t.props.onFocus(t.props.option,e)},t}return T(t,e),t.prototype.render=function(){var e=this.props.option;return r.createElement(M.a,{overlay:e.label,placement:"left"},r.createElement("div",{className:this.props.className,onMouseDown:this.handleMouseDown,onMouseEnter:this.handleMouseEnter,onMouseMove:this.handleMouseMove,role:"listitem"},r.createElement("div",null,r.createElement(p.a,{className:"little-spacer-right"}),e.label)))},t}(r.PureComponent),q=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(t,n)};return function(t,n){function a(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(a.prototype=n.prototype,new a)}}(),J=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.node=null,t.mounted=!1,t.state={loading:!1},t.parseBranches=function(e){return S()(e,[function(e){return e.isMain},function(e){return e.name}]).map((function(e){return{value:e.name,label:e.name,isMain:e.isMain}}))},t.setCurrentTarget=function(e){t.node=e.target},t.handleChange=function(e){t.props.onChange(t.props.project.key,e),t.setState({selectedBranch:e})},t.handleOpen=function(){if(t.state.branches&&t.node)t.props.onOpen(t.node,t.state.branches.length);else{var e=t.props.project;t.setState({loading:!0}),Object(D.d)(e.key).then((function(e){var n=t.parseBranches(e);t.node&&t.props.onOpen(t.node,n.length),t.mounted&&t.setState({branches:n,loading:!1})}),(function(){}))}},t}return q(t,e),t.prototype.componentDidMount=function(){this.mounted=!0},t.prototype.componentWillUnmount=function(){this.mounted=!1},t.prototype.render=function(){var e=this.props,t=e.checked,n=e.onCheck,a=e.onClose,o=e.project,c=this.state.branches||[{value:o.branch,label:o.branch,isMain:o.isMain}],i=o.enabled?this.state.selectedBranch||o.branch:this.state.selectedBranch;return r.createElement("tr",{key:o.key},r.createElement("td",{className:"text-center"},r.createElement(B.a,{checked:t,id:o.key,onCheck:n})),r.createElement("td",{className:"nowrap hide-overflow branch-name-row"},r.createElement(M.a,{overlay:o.name},r.createElement("span",null,r.createElement(R.a,{qualifier:"TRK"})," ",o.name))),r.createElement("td",null,r.createElement(U.a,{className:"width100",clearable:!1,disabled:!t,onChange:this.handleChange,onClose:a,onFocus:this.setCurrentTarget,onOpen:this.handleOpen,optionComponent:L,options:c,searchable:!1,value:i}),r.createElement(O.a,{className:"project-branch-row-spinner",loading:this.state.loading})))},t}(r.PureComponent),K=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(t,n)};return function(t,n){function a(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(a.prototype=n.prototype,new a)}}(),z=function(){return(z=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var r in t=arguments[n])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e}).apply(this,arguments)},W=function(e,t,n,a){return new(n||(n=Promise))((function(r,o){function c(e){try{s(a.next(e))}catch(e){o(e)}}function i(e){try{s(a.throw(e))}catch(e){o(e)}}function s(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(c,i)}s((a=a.apply(e,t||[])).next())}))},I=function(e,t){var n,a,r,o,c={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return o={next:i(0),throw:i(1),return:i(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function i(o){return function(i){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;c;)try{if(n=1,a&&(r=2&o[0]?a.return:o[0]?a.throw||((r=a.return)&&r.call(a),0):a.next)&&!(r=r.call(a,o[1])).done)return r;switch(a=0,r&&(o=[2&o[0],r.value]),o[0]){case 0:case 1:r=o;break;case 4:return c.label++,{value:o[1],done:!1};case 5:c.label++,a=o[1],o=[0];continue;case 7:o=c.ops.pop(),c.trys.pop();continue;default:if(!(r=(r=c.trys).length>0&&r[r.length-1])&&(6===o[0]||2===o[0])){c=0;continue}if(3===o[0]&&(!r||o[1]>r[0]&&o[1]<r[3])){c.label=o[1];break}if(6===o[0]&&c.label<r[1]){c.label=r[1],r=o;break}if(r&&c.label<r[2]){c.label=r[2],c.ops.push(o);break}r[2]&&c.ops.pop(),c.trys.pop();continue}o=t.call(e,c)}catch(e){o=[6,e],a=0}finally{n=r=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,i])}}},G=function(){for(var e=0,t=0,n=arguments.length;t<n;t++)e+=arguments[t].length;var a=Array(e),r=0;for(t=0;t<n;t++)for(var o=arguments[t],c=0,i=o.length;c<i;c++,r++)a[r]=o[c];return a},H=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.mounted=!1,t.node=null,t.currentSelect=null,t.state={loading:!1,name:"",projects:[],selected:[],selectedBranches:{}},t.stopLoading=function(){t.mounted&&t.setState({loading:!1})},t.canSubmit=function(){var e=v()(t.state.selectedBranches,(function(e,n){return!e&&t.state.selected.includes(n)}));return!t.state.loading&&t.state.name.length>0&&!e&&t.state.selected.length>0},t.handleInputChange=function(e){t.setState({name:e.currentTarget.value})},t.handleFormSubmit=function(){return W(t,void 0,void 0,(function(){var e,t,n=this;return I(this,(function(a){switch(a.label){case 0:return e=this.state.selected,t=e.map((function(e){var t=n.state.selectedBranches[e];return!t||t.isMain?"":t.value})),this.props.branch?[4,Object(c.l)({application:this.props.application.key,branch:this.props.branch.name,name:this.state.name,project:e,projectBranch:t})]:[3,2];case 1:return a.sent(),this.props.onUpdate&&this.props.onUpdate(this.state.name),[3,4];case 2:return[4,Object(c.a)({application:this.props.application.key,branch:this.state.name,project:e,projectBranch:t})];case 3:a.sent(),this.props.onCreate&&this.props.onCreate({name:this.state.name,isMain:!1}),a.label=4;case 4:return this.props.onClose(),[2]}}))}))},t.handleProjectCheck=function(e,n){t.setState((function(t){return{selected:e?G(t.selected,[n]):h()(t.selected,n)}}))},t.handleBranchChange=function(e,n){t.setState((function(t){var a;return{selectedBranches:z(z({},t.selectedBranches),(a={},a[e]=n,a))}}))},t.handleSelectorClose=function(){t.node&&t.node.classList.add("selector-hidden")},t.handleSelectorDirection=function(e,n){if(t.node){var a=t.node.getBoundingClientRect().top,r=t.node.offsetHeight,o=Math.min(220,22*(n+1));e.getBoundingClientRect().top+o>a+r?t.node.classList.add("inverted-direction"):t.node.classList.remove("inverted-direction"),t.node.classList.remove("selector-hidden")}},t.renderProjectsList=function(){return r.createElement(r.Fragment,null,r.createElement("strong",{className:"spacer-left spacer-top"},Object(o.translate)("application_console.branches.configuration")),r.createElement("p",{className:"spacer-top big-spacer-bottom spacer-left spacer-right"},Object(o.translate)("application_console.branches.create.help")),r.createElement("table",{className:"data zebra"},r.createElement("thead",null,r.createElement("tr",null,r.createElement("th",{className:"thin"}),r.createElement("th",{className:"thin"},Object(o.translate)("project")),r.createElement("th",null,Object(o.translate)("branch")))),r.createElement("tbody",null,t.state.projects.map((function(e){return r.createElement(J,{checked:t.state.selected.includes(e.key),key:e.key,onChange:t.handleBranchChange,onCheck:t.handleProjectCheck,onClose:t.handleSelectorClose,onOpen:t.handleSelectorDirection,project:e})})))))},t}return K(t,e),t.prototype.componentDidMount=function(){var e=this;this.mounted=!0;var t=this.props.application,n=this.props.branch?this.props.branch.name:void 0;this.setState({loading:!0}),Object(c.g)(t.key,n).then((function(t){var a=t.projects;if(e.mounted){var r=a.filter((function(t){return e.props.enabledProjectsKey.includes(t.key)})),o=r.filter((function(e){return e.selected})).map((function(e){return e.key})),c={};r.forEach((function(e){e.enabled?c[e.key]={value:e.branch||"",label:e.branch||"",isMain:e.isMain||!1}:c[e.key]=null})),e.setState({name:n||"",selected:o,loading:!1,projects:r,selectedBranches:c})}}),(function(){e.props.onClose()}))},t.prototype.componentWillUnmount=function(){this.mounted=!1},t.prototype.render=function(){var e=this,t=void 0!==this.props.branch,n=Object(o.translate)("application_console.branches",t?"update":"create");return r.createElement(g.a,{header:n,onClose:this.props.onClose,onSubmit:this.handleFormSubmit,size:"medium"},(function(a){var c=a.onCloseClick,i=a.onFormSubmit,l=a.submitting;return r.createElement("form",{className:"views-form",onSubmit:i},r.createElement("div",{className:"modal-head"},r.createElement("h2",null,n)),r.createElement("div",{className:"modal-body modal-container selector-hidden",ref:function(t){return e.node=t}},e.state.loading?r.createElement("div",{className:"text-center big-spacer-top big-spacer-bottom"},r.createElement("i",{className:"spinner spacer-right"})):r.createElement(r.Fragment,null,r.createElement(P.a,{className:"modal-field"}),r.createElement("div",{className:"modal-field"},r.createElement("label",{htmlFor:"view-edit-name"},Object(o.translate)("name"),r.createElement(w.a,null)),r.createElement("input",{autoFocus:!0,className:"input-super-large",maxLength:250,name:"name",onChange:e.handleInputChange,size:50,type:"text",value:e.state.name})),e.renderProjectsList())),r.createElement("div",{className:"modal-foot"},r.createElement(O.a,{className:"spacer-right",loading:l}),r.createElement(s.SubmitButton,{disabled:l||!e.canSubmit()},Object(o.translate)("application_console.branches",t?"update":"create","verb")),r.createElement(s.ResetButtonLink,{onClick:c},Object(o.translate)("application_console.branches.cancel"))))}))},t}(r.PureComponent),Q=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(t,n)};return function(t,n){function a(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(a.prototype=n.prototype,new a)}}(),V=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.state={isUpdating:!1},t.handleDelete=function(){var e=t.props,n=e.application,a=e.branch;return Object(c.e)(n.key,a.name).then((function(){t.props.onUpdateBranches(h()(n.branches,a))}))},t.handleUpdate=function(e){t.props.onUpdateBranches(t.props.application.branches.map((function(n){return n.name===t.props.branch.name&&(n.name=e),n})))},t.handleCloseForm=function(){t.setState({isUpdating:!1})},t.handleUpdateClick=function(){t.setState({isUpdating:!0})},t}return Q(t,e),t.prototype.render=function(){var e=this;return r.createElement(r.Fragment,null,r.createElement(b.a,{confirmButtonText:Object(o.translate)("delete"),isDestructive:!0,modalBody:Object(o.translateWithParameters)("application_console.branches.delete.warning_x",this.props.branch.name),modalHeader:Object(o.translate)("application_console.branches.delete"),onConfirm:this.handleDelete},(function(t){var n=t.onClick;return r.createElement(f.a,null,r.createElement(d.ActionsDropdownItem,{onClick:e.handleUpdateClick},Object(o.translate)("edit")),r.createElement(d.ActionsDropdownItem,{destructive:!0,onClick:n},Object(o.translate)("delete")))})),this.state.isUpdating&&r.createElement(H,{application:this.props.application,branch:this.props.branch,enabledProjectsKey:this.props.application.projects.filter((function(e){return e.enabled})).map((function(e){return e.key})),onClose:this.handleCloseForm,onUpdate:this.handleUpdate}))},t}(r.PureComponent);function X(e){var t=e.application,n=e.branch;return r.createElement("tr",null,r.createElement("td",null,r.createElement(p.a,{className:"little-spacer-right"}),n.name,n.isMain&&r.createElement("span",{className:"badge spacer-left"},Object(o.translate)("application_console.branches.main_branch"))),r.createElement("td",{className:"thin nowrap"},!n.isMain&&r.createElement(V,{application:t,branch:n,onUpdateBranches:e.onUpdateBranches})))}var Y=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(t,n)};return function(t,n){function a(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(a.prototype=n.prototype,new a)}}(),Z=function(){for(var e=0,t=0,n=arguments.length;t<n;t++)e+=arguments[t].length;var a=Array(e),r=0;for(t=0;t<n;t++)for(var o=arguments[t],c=0,i=o.length;c<i;c++,r++)a[r]=o[c];return a},$=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.state={creating:!1},t.handleCreate=function(e){t.props.onUpdateBranches(Z(t.props.application.branches,[e]))},t.handleCreateFormClose=function(){t.setState({creating:!1})},t.handleCreateClick=function(){t.setState({creating:!0})},t.canCreateBranches=function(){return t.props.application.projects&&t.props.application.projects.some((function(e){return Boolean(e.enabled)}))},t}return Y(t,e),t.prototype.renderBranches=function(e){var t=this,n=this.props.application;return e?r.createElement("div",{className:"app-branches-list"},r.createElement("table",{className:"data zebra"},r.createElement("tbody",null,n.branches.map((function(e){return r.createElement(X,{application:n,branch:e,key:e.name,onUpdateBranches:t.props.onUpdateBranches})}))))):r.createElement("div",{className:"app-branches-list"},r.createElement("p",{className:"text-center big-spacer-top"},Object(o.translate)("application_console.branches.no_branches")))},t.prototype.render=function(){var e=this.props.application,t=this.canCreateBranches();return r.createElement("div",{className:"app-branches-console"},r.createElement("div",{className:"boxed-group-actions"},r.createElement(s.Button,{disabled:!t,onClick:this.handleCreateClick},Object(o.translate)("application_console.branches.create"))),r.createElement("h2",{className:"text-limited big-spacer-top",title:Object(o.translate)("application_console.branches")},Object(o.translate)("application_console.branches")),r.createElement("p",null,Object(o.translate)("application_console.branches.help")),this.renderBranches(t),this.state.creating&&r.createElement(H,{application:e,enabledProjectsKey:e.projects.map((function(e){return e.key})),onClose:this.handleCreateFormClose,onCreate:this.handleCreate}))},t}(r.PureComponent),ee=n(838),te=n.n(ee),ne=n(817),ae=n.n(ne),re=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(t,n)};return function(t,n){function a(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(a.prototype=n.prototype,new a)}}(),oe=function(){return(oe=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var r in t=arguments[n])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e}).apply(this,arguments)},ce=function(){for(var e=0,t=0,n=arguments.length;t<n;t++)e+=arguments[t].length;var a=Array(e),r=0;for(t=0;t<n;t++)for(var o=arguments[t],c=0,i=o.length;c<i;c++,r++)a[r]=o[c];return a},ie=function(e){function t(t){var n=e.call(this,t)||this;return n.mounted=!1,n.loadApplicationProjects=function(e){return Object(c.i)({application:n.state.lastSearchParams.applicationKey,p:e.page,ps:e.pageSize,q:""!==e.query?e.query:void 0,selected:e.filter})},n.fetchProjects=function(e){return n.loadApplicationProjects(e).then((function(t){n.mounted&&n.setState((function(a){var r=null!=e.page&&e.page>1,o=n.dealWithProjects(t,r,a),c=o.projects,i=o.selectedProjects;return{disabledProjects:o.disabledProjects,lastSearchParams:oe(oe({},a.lastSearchParams),e),needToReload:!1,projects:c,projectsTotalCount:t.paging.total,selectedProjects:i}}))}))},n.dealWithProjects=function(e,t,n){var a=t?ce(n.projects,e.projects):e.projects,r=e.projects.filter((function(e){return e.selected})).map((function(e){return e.key})),o=t?ce(n.selectedProjects,r):r;return{disabledProjects:t?ce(n.disabledProjects):[],projects:a,selectedProjects:o}},n.handleSelect=function(e){return Object(c.b)(n.props.application.key,e).then((function(){n.mounted&&n.setState((function(t){var a=t.projects.find((function(t){return t.key===e}));return a&&n.props.onAddProject&&n.props.onAddProject(a),{needToReload:!0,selectedProjects:ce(t.selectedProjects,[e])}}))}))},n.handleUnselect=function(e){return Object(c.k)(n.props.application.key,e).then((function(){n.mounted&&n.setState((function(t){return n.props.onRemoveProject&&n.props.onRemoveProject(e),{needToReload:!0,selectedProjects:h()(t.selectedProjects,e)}}))}))},n.renderElement=function(e){var t=te()(n.state.projects,{key:e});return void 0===t?"":r.createElement("div",{className:"views-project-item display-flex-center"},r.createElement(R.a,{className:"spacer-right",qualifier:"TRK"}),r.createElement("div",null,r.createElement("div",{title:t.name},t.name),r.createElement("div",{className:"note"},t.key)))},n.state={disabledProjects:[],lastSearchParams:{applicationKey:t.application.key,query:"",filter:ne.SelectListFilter.Selected},needToReload:!1,projects:[],selectedProjects:[]},n}return re(t,e),t.prototype.componentDidMount=function(){this.mounted=!0},t.prototype.componentDidUpdate=function(e){var t=this;e.application.key!==this.props.application.key&&this.setState((function(e){return{lastSearchParams:oe(oe({},e.lastSearchParams),{applicationKey:t.props.application.key})}}),(function(){return t.fetchProjects(t.state.lastSearchParams)}))},t.prototype.componentWillUnmount=function(){this.mounted=!1},t.prototype.render=function(){var e=this.state,t=e.projects,n=e.selectedProjects;return r.createElement(ae.a,{disabledElements:this.state.disabledProjects,elements:t.map((function(e){return e.key})),elementsTotalCount:this.state.projectsTotalCount,needToReload:this.state.needToReload&&this.state.lastSearchParams&&this.state.lastSearchParams.filter!==ne.SelectListFilter.All,onSearch:this.fetchProjects,onSelect:this.handleSelect,onUnselect:this.handleUnselect,renderElement:this.renderElement,selectedElements:n,withPaging:!0})},t}(r.PureComponent),se=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(t,n)};return function(t,n){function a(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(a.prototype=n.prototype,new a)}}(),le=function(e,t,n,a){return new(n||(n=Promise))((function(r,o){function c(e){try{s(a.next(e))}catch(e){o(e)}}function i(e){try{s(a.throw(e))}catch(e){o(e)}}function s(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(c,i)}s((a=a.apply(e,t||[])).next())}))},pe=function(e,t){var n,a,r,o,c={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return o={next:i(0),throw:i(1),return:i(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function i(o){return function(i){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;c;)try{if(n=1,a&&(r=2&o[0]?a.return:o[0]?a.throw||((r=a.return)&&r.call(a),0):a.next)&&!(r=r.call(a,o[1])).done)return r;switch(a=0,r&&(o=[2&o[0],r.value]),o[0]){case 0:case 1:r=o;break;case 4:return c.label++,{value:o[1],done:!1};case 5:c.label++,a=o[1],o=[0];continue;case 7:o=c.ops.pop(),c.trys.pop();continue;default:if(!(r=(r=c.trys).length>0&&r[r.length-1])&&(6===o[0]||2===o[0])){c=0;continue}if(3===o[0]&&(!r||o[1]>r[0]&&o[1]<r[3])){c.label=o[1];break}if(6===o[0]&&c.label<r[1]){c.label=r[1],r=o;break}if(r&&c.label<r[2]){c.label=r[2],c.ops.push(o);break}r[2]&&c.ops.pop(),c.trys.pop();continue}o=t.call(e,c)}catch(e){o=[6,e],a=0}finally{n=r=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,i])}}},ue=function(e){function t(t){var n=e.call(this,t)||this;return n.handleNameChange=function(e){n.setState({name:e.currentTarget.value})},n.handleDescriptionChange=function(e){n.setState({description:e.currentTarget.value})},n.handleFormSubmit=function(){return le(n,void 0,void 0,(function(){return pe(this,(function(e){switch(e.label){case 0:return[4,this.props.onEdit(this.state.name,this.state.description)];case 1:return e.sent(),this.props.onClose(),[2]}}))}))},n.state={description:t.application.description||"",name:t.application.name},n}return se(t,e),t.prototype.render=function(){var e=this;return r.createElement(g.a,{header:this.props.header,onClose:this.props.onClose,onSubmit:this.handleFormSubmit,size:"small"},(function(t){var n=t.onCloseClick,a=t.onFormSubmit,c=t.submitting;return r.createElement("form",{onSubmit:a},r.createElement("div",{className:"modal-head"},r.createElement("h2",null,e.props.header)),r.createElement("div",{className:"modal-body"},r.createElement("div",{className:"modal-field"},r.createElement("label",{htmlFor:"view-edit-name"},Object(o.translate)("name")),r.createElement("input",{autoFocus:!0,id:"view-edit-name",maxLength:100,name:"name",onChange:e.handleNameChange,size:50,type:"text",value:e.state.name})),r.createElement("div",{className:"modal-field"},r.createElement("label",{htmlFor:"view-edit-description"},Object(o.translate)("description")),r.createElement("textarea",{id:"view-edit-description",name:"description",onChange:e.handleDescriptionChange,value:e.state.description}))),r.createElement("div",{className:"modal-foot"},r.createElement(O.a,{className:"spacer-right",loading:c}),r.createElement(s.SubmitButton,{disabled:c||!e.state.name.length},Object(o.translate)("save")),r.createElement(s.ResetButtonLink,{onClick:n},Object(o.translate)("cancel"))))}))},t}(r.PureComponent);function he(e){var t=r.useState(!1),n=t[0],a=t[1],c=e.application;return e.loading?r.createElement("i",{className:"spinner spacer"}):r.createElement("div",{className:"page page-limited"},r.createElement("div",{className:"boxed-group",id:"view-details"},r.createElement("div",{className:"boxed-group-actions"},r.createElement(s.Button,{className:"little-spacer-right",id:"view-details-edit",onClick:function(){return a(!0)}},Object(o.translate)("edit")),r.createElement(s.Button,{className:"little-spacer-right",onClick:e.onRefresh},Object(o.translate)("application_console.recompute"))),r.createElement("header",{className:"boxed-group-header",id:"view-details-header"},r.createElement("h2",{className:"text-limited",title:c.name},c.name)),r.createElement("div",{className:"boxed-group-inner",id:"view-details-content"},r.createElement("div",{className:"big-spacer-bottom"},c.description&&r.createElement("div",{className:"little-spacer-bottom"},c.description),r.createElement("div",{className:"subtitle"},Object(o.translate)("key"),": ",c.key)),r.createElement(ie,{onAddProject:e.onAddProject,onRemoveProject:e.onRemoveProject,application:c}),r.createElement($,{application:c,onUpdateBranches:e.onUpdateBranches})),n&&r.createElement(ue,{header:Object(o.translate)("portfolios.edit_application"),onClose:function(){return a(!1)},onEdit:e.onEdit,application:c})))}var de=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(t,n)};return function(t,n){function a(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(a.prototype=n.prototype,new a)}}(),fe=function(){return(fe=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var r in t=arguments[n])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e}).apply(this,arguments)},me=function(e,t,n,a){return new(n||(n=Promise))((function(r,o){function c(e){try{s(a.next(e))}catch(e){o(e)}}function i(e){try{s(a.throw(e))}catch(e){o(e)}}function s(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(c,i)}s((a=a.apply(e,t||[])).next())}))},be=function(e,t){var n,a,r,o,c={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return o={next:i(0),throw:i(1),return:i(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function i(o){return function(i){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;c;)try{if(n=1,a&&(r=2&o[0]?a.return:o[0]?a.throw||((r=a.return)&&r.call(a),0):a.next)&&!(r=r.call(a,o[1])).done)return r;switch(a=0,r&&(o=[2&o[0],r.value]),o[0]){case 0:case 1:r=o;break;case 4:return c.label++,{value:o[1],done:!1};case 5:c.label++,a=o[1],o=[0];continue;case 7:o=c.ops.pop(),c.trys.pop();continue;default:if(!(r=(r=c.trys).length>0&&r[r.length-1])&&(6===o[0]||2===o[0])){c=0;continue}if(3===o[0]&&(!r||o[1]>r[0]&&o[1]<r[3])){c.label=o[1];break}if(6===o[0]&&c.label<r[1]){c.label=r[1],r=o;break}if(r&&c.label<r[2]){c.label=r[2],c.ops.push(o);break}r[2]&&c.ops.pop(),c.trys.pop();continue}o=t.call(e,c)}catch(e){o=[6,e],a=0}finally{n=r=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,i])}}},ye=function(){for(var e=0,t=0,n=arguments.length;t<n;t++)e+=arguments[t].length;var a=Array(e),r=0;for(t=0;t<n;t++)for(var o=arguments[t],c=0,i=o.length;c<i;c++,r++)a[r]=o[c];return a},ve=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.mounted=!1,t.state={loading:!1},t.updateApplicationState=function(e){t.setState((function(t){return t.application?{application:fe(fe({},t.application),e(t.application))}:null}))},t.fetchDetails=function(){return me(t,void 0,void 0,(function(){var e;return be(this,(function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),[4,Object(c.g)(this.props.component.key)];case 1:return e=t.sent(),this.mounted&&this.setState({application:e,loading:!1}),[3,3];case 2:return t.sent(),this.mounted&&this.setState({loading:!1}),[3,3];case 3:return[2]}}))}))},t.handleRefreshClick=function(){return me(t,void 0,void 0,(function(){return be(this,(function(e){switch(e.label){case 0:return this.state.application?[4,Object(c.j)(this.state.application.key)]:[3,2];case 1:e.sent(),Object(i.a)(Object(o.translate)("application_console.refresh_started")),e.label=2;case 2:return[2]}}))}))},t.handleEdit=function(e,n){return me(t,void 0,void 0,(function(){return be(this,(function(t){switch(t.label){case 0:return this.state.application?[4,Object(c.f)(this.state.application.key,e,n)]:[3,2];case 1:t.sent(),t.label=2;case 2:return this.mounted&&this.updateApplicationState((function(){return{name:e,description:n}})),[2]}}))}))},t.handleAddProject=function(e){t.updateApplicationState((function(t){return{projects:ye(t.projects,[e])}}))},t.handleRemoveProject=function(e){t.updateApplicationState((function(t){return{projects:t.projects.filter((function(t){return t.key!==e}))}}))},t.handleUpdateBranches=function(e){t.updateApplicationState((function(){return{branches:e}}))},t}return de(t,e),t.prototype.componentDidMount=function(){this.mounted=!0,this.fetchDetails()},t.prototype.componentDidUpdate=function(e){e.component.key!==this.props.component.key&&this.fetchDetails()},t.prototype.componentWillUnmount=function(){this.mounted=!1},t.prototype.render=function(){var e=this.state,t=e.application,n=e.loading;return t?r.createElement(he,{loading:n,application:t,onAddProject:this.handleAddProject,onEdit:this.handleEdit,onRefresh:this.handleRefreshClick,onRemoveProject:this.handleRemoveProject,onUpdateBranches:this.handleUpdateBranches}):null},t}(r.PureComponent);t.default=ve},785:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var a=n(765),r=n(763);function o(e){Object(r.default)().dispatch(a.b(e))}},898:function(e,t,n){"use strict";n.d(t,"h",(function(){return o})),n.d(t,"g",(function(){return c})),n.d(t,"a",(function(){return i})),n.d(t,"l",(function(){return s})),n.d(t,"e",(function(){return l})),n.d(t,"i",(function(){return p})),n.d(t,"b",(function(){return u})),n.d(t,"k",(function(){return h})),n.d(t,"j",(function(){return d})),n.d(t,"c",(function(){return f})),n.d(t,"d",(function(){return m})),n.d(t,"f",(function(){return b}));var a=n(49),r=n(673);function o(e,t){return Object(a.getJSON)("/api/applications/show_leak",{application:e,branch:t}).then((function(e){return e.leaks}),r.a)}function c(e,t){return Object(a.getJSON)("/api/applications/show",{application:e,branch:t}).then((function(e){return e.application}),r.a)}function i(e){return Object(a.post)("/api/applications/create_branch",e).catch(r.a)}function s(e){return Object(a.post)("/api/applications/update_branch",e).catch(r.a)}function l(e,t){return Object(a.post)("/api/applications/delete_branch",{application:e,branch:t}).catch(r.a)}function p(e){return Object(a.getJSON)("/api/applications/search_projects",e).catch(r.a)}function u(e,t){return Object(a.post)("/api/applications/add_project",{application:e,project:t}).catch(r.a)}function h(e,t){return Object(a.post)("/api/applications/remove_project",{application:e,project:t}).catch(r.a)}function d(e){return Object(a.post)("/api/applications/refresh",{key:e}).catch(r.a)}function f(e,t,n,o){return Object(a.postJSON)("/api/applications/create",{description:t,key:n,name:e,visibility:o}).catch(r.a)}function m(e){return Object(a.post)("/api/applications/delete",{application:e}).catch(r.a)}function b(e,t,n){return Object(a.post)("/api/applications/update",{name:t,description:n,application:e}).catch(r.a)}},973:function(e,t,n){"use strict";n.d(t,"d",(function(){return o})),n.d(t,"e",(function(){return c})),n.d(t,"a",(function(){return i})),n.d(t,"b",(function(){return s})),n.d(t,"f",(function(){return l})),n.d(t,"c",(function(){return p}));var a=n(49),r=n(673);function o(e){return Object(a.getJSON)("/api/project_branches/list",{project:e}).then((function(e){return e.branches}),r.a)}function c(e){return Object(a.getJSON)("/api/project_pull_requests/list",{project:e}).then((function(e){return e.pullRequests}),r.a)}function i(e){return Object(a.post)("/api/project_branches/delete",e).catch(r.a)}function s(e){return Object(a.post)("/api/project_pull_requests/delete",e).catch(r.a)}function l(e,t){return Object(a.post)("/api/project_branches/rename",{project:e,name:t}).catch(r.a)}function p(e,t,n){return Object(a.post)("/api/project_branches/set_automatic_deletion_protection",{project:e,branch:t,value:n}).catch(r.a)}}}]);
//# sourceMappingURL=344.1648830816893.chunk.js.map
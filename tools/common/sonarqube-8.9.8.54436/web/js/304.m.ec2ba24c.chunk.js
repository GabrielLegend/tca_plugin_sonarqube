(window.webpackJsonp=window.webpackJsonp||[]).push([[304],{1690:function(e,t,n){var a=n(313),r=n(1691);"string"==typeof(r=r.__esModule?r.default:r)&&(r=[[e.i,r,""]]);var s={insert:"head",singleton:!1},c=(a(r,s),r.locals?r.locals:{});e.exports=c},1691:function(e,t,n){(t=n(314)(!1)).push([e.i,".project-baseline{padding:32px}.project-baseline-setting{display:flex;flex-direction:column;max-height:60vh;padding-top:2px}.project-baseline-selector .general-setting{margin-left:7px}.branch-baseline-selector>hr{margin:0 -32px 32px}.branch-baseline-setting-modal{min-height:450px;display:flex;flex-direction:column}.branch-analysis-list-wrapper{display:flex;flex-direction:column;overflow:hidden;position:relative;min-height:200px}.branch-analysis-list{overflow-y:auto;padding-left:12px;padding-right:15px;min-height:50px}.branch-analysis-list>ul{padding-top:18px}.branch-analysis-date{margin-bottom:16px;font-size:15px;font-weight:700}.branch-analysis-day{margin-top:8px;margin-bottom:24px}.branch-analysis{display:flex;justify-content:space-between;cursor:pointer;padding:8px;border-top:1px solid #e6e6e6;border-bottom:1px solid #e6e6e6}.branch-analysis+.branch-analysis{border-top:none}.branch-analysis:hover{background-color:#cae3f2}.branch-analysis>.project-activity-events{flex:1 0 50%}.branch-analysis-time{width:150px}.branch-analysis-version-badge{margin-left:-12px;padding-top:8px;padding-bottom:8px;background-color:#fff}.branch-analysis-version-badge.sticky+.branch-analysis-days-list{padding-top:36px}.branch-analysis-version-badge.first,.branch-analysis-version-badge.sticky{position:absolute;top:1px;left:13px;right:16px;padding-top:24px;z-index:1}.branch-analysis-version-badge .badge{max-width:385px;border-radius:0 2px 2px 0;font-weight:700;font-size:12px;letter-spacing:0;overflow:hidden;text-overflow:ellipsis}.branch-setting-warning{background-color:#fcf8e3!important}.project-activity-event-icon.VERSION{color:#4b9fd5}.project-activity-event-icon.QUALITY_GATE{color:#9139d4}.project-activity-event-icon.QUALITY_PROFILE{color:#ccc}.project-activity-event-icon.DEFINITION_CHANGE{color:#33a759}.project-activity-event-icon.OTHER{color:#442d1b}",""]),e.exports=t},1848:function(e,t,n){"use strict";n.r(t);var a=n(325),r=n(327),s=n(382),c=n.n(s),i=n(311),l=n(2),o=n(456),d=n.n(o),u=n(319),h=n.n(u),p=n(31),m=n(761),b=n(341),g=n(328),f=(n(1690),n(762)),y=n(316),v=n(318);function E(e){const{canAdmin:t}=e;return l.createElement("header",{className:"page-header"},l.createElement("h1",{className:"page-title"},Object(p.translate)("project_baseline.page")),l.createElement("p",{className:"page-description"},l.createElement(y.FormattedMessage,{defaultMessage:Object(p.translate)("project_baseline.page.description"),id:"project_baseline.page.description",values:{link:l.createElement(v.c,{to:"/documentation/project-administration/new-code-period/"},Object(p.translate)("project_baseline.page.description.link"))}}),l.createElement("br",null),t&&l.createElement(y.FormattedMessage,{defaultMessage:Object(p.translate)("project_baseline.page.description2"),id:"project_baseline.page.description2",values:{link:l.createElement(v.c,{to:"/admin/settings?category=new_code_period"},Object(p.translate)("project_baseline.page.description2.link"))}})))}var S=n(312),O=n(331),j=n.n(O),_=n(26),N=n(660),C=n.n(N);function A({disabled:e,onSelect:t,selected:n}){return l.createElement(C.a,{disabled:e,onClick:()=>t("SPECIFIC_ANALYSIS"),selected:n,title:Object(p.translate)("baseline.specific_analysis")},l.createElement("p",{className:"big-spacer-bottom"},Object(p.translate)("baseline.specific_analysis.description")))}var P=n(808),k=n(809),x=n(654),B=n.n(x),R=n(317),D=n.n(R),I=n(478),w=n.n(I),F=n(340),L=n.n(F),V=n(346),M=n.n(V);function T(e){return e.isInvalid?l.createElement(D.a,{overlay:Object(p.translateWithParameters)("baseline.reference_branch.does_not_exist",e.value)},l.createElement("span",null,e.value," ",l.createElement(w.a,null))):l.createElement(l.Fragment,null,l.createElement("span",{title:e.disabled?Object(p.translate)("baseline.reference_branch.cannot_be_itself"):void 0},e.value),e.isMain&&l.createElement("div",{className:"badge spacer-left"},Object(p.translate)("branches.main_branch")))}function U(e){const{branchList:t,className:n,disabled:a,referenceBranch:r,selected:s,settingLevel:c}=e,i=t.find(e=>e.value===r)||{value:r,isMain:!1,isInvalid:!0};return l.createElement(C.a,{className:n,disabled:a,onClick:()=>e.onSelect("REFERENCE_BRANCH"),selected:s,title:Object(p.translate)("baseline.reference_branch")},l.createElement(l.Fragment,null,l.createElement("p",null,Object(p.translate)("baseline.reference_branch.description")),s&&l.createElement(l.Fragment,null,"project"===c&&l.createElement("p",{className:"spacer-top"},Object(p.translate)("baseline.reference_branch.description2")),l.createElement("div",{className:"big-spacer-top display-flex-column"},l.createElement(M.a,{className:"spacer-bottom"}),l.createElement("label",{className:"text-middle",htmlFor:"reference_branch"},l.createElement("strong",null,Object(p.translate)("baseline.reference_branch.choose")),l.createElement(L.a,null)),l.createElement(B.a,{autofocus:!1,className:"little-spacer-top spacer-bottom",defaultOptions:t,minimumQueryLength:1,onSearch:e=>Promise.resolve(t.filter(t=>t.value.includes(e))),onSelect:t=>e.onChangeReferenceBranch(t.value),renderOption:T,value:i})))))}var Y=n(732),G=n.n(Y),H=n(451),z=n(435),q=n(753),K=n(398),Q=n.n(K),W=n(348),J=n.n(W),X=n(363),Z=n.n(X),$=n(574),ee=n.n($),te=n(980),ne=n(686);function ae(e){const{analyses:t,loading:n,range:a,selectedAnalysisKey:r}=e,s=l.useMemo(()=>Object(ne.f)(t,{category:""}),[t]),c=s.length>1||1===s.length&&Object.keys(s[0].byDay).length>0;return l.createElement(l.Fragment,null,l.createElement("div",{className:"spacer-bottom"},Object(p.translate)("baseline.analysis_from"),l.createElement(J.a,{autoBlur:!0,className:"input-medium spacer-left",clearable:!1,onChange:e.handleRangeChange,options:[{label:Object(p.translate)("baseline.branch_analyses.ranges.30days"),value:30},{label:Object(p.translate)("baseline.branch_analyses.ranges.allTime"),value:0}],searchable:!1,value:a})),l.createElement("div",{className:"branch-analysis-list-wrapper"},l.createElement("div",{className:"bordered branch-analysis-list",onScroll:e.handleScroll,ref:e.registerScrollableNode},n&&l.createElement(h.a,{className:"big-spacer-top"}),n||c?l.createElement("ul",null,s.map((n,a)=>{const s=Object.keys(n.byDay);return s.length<=0?null:l.createElement("li",{key:n.key||"noversion"},n.version&&l.createElement("div",{className:i("branch-analysis-version-badge",{first:0===a,sticky:e.shouldStick(n.version)}),ref:e.registerBadgeNode(n.version)},l.createElement(D.a,{mouseEnterDelay:.5,overlay:"".concat(Object(p.translate)("version")," ").concat(n.version)},l.createElement("span",{className:"badge"},n.version))),l.createElement("ul",{className:"branch-analysis-days-list"},s.map(a=>l.createElement("li",{className:"branch-analysis-day","data-day":Object(_.toShortNotSoISOString)(Number(a)),key:a},l.createElement("div",{className:"branch-analysis-date"},l.createElement(Z.a,{date:Number(a),long:!0})),l.createElement("ul",{className:"branch-analysis-analyses-list"},null!=n.byDay[a]&&n.byDay[a].map(n=>function(e){const{analysis:t,isFirst:n,onSelectAnalysis:a,selectedAnalysisKey:r}=e;return l.createElement("li",{className:i("branch-analysis",{selected:t.key===r}),"data-date":Object(_.parseDate)(t.date).valueOf(),key:t.key,onClick:()=>a(t)},l.createElement("div",{className:"branch-analysis-time spacer-right"},l.createElement(ee.a,{date:Object(_.parseDate)(t.date),long:!1},e=>l.createElement("time",{className:"text-middle",dateTime:Object(_.parseDate)(t.date).toISOString()},e))),t.events.length>0&&l.createElement(te.a,{analysisKey:t.key,events:t.events,isFirst:n}),l.createElement("div",{className:"analysis-selection-button"},l.createElement(Q.a,{checked:t.key===r,onCheck:()=>{},value:""})))}({analysis:n,selectedAnalysisKey:r,isFirst:t[0].key===n.key,onSelectAnalysis:e.onSelectAnalysis})))))))})):l.createElement("div",{className:"big-spacer-top big-spacer-bottom strong"},Object(p.translate)("baseline.no_analyses")))))}function re(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function se(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class ce extends l.PureComponent{constructor(e){super(e),this.mounted=!1,this.badges={},this.state={analyses:[],loading:!0,range:30,scroll:0},this.handleScroll=e=>{e.currentTarget&&this.updateScroll(e.currentTarget.scrollTop)},this.updateScroll=e=>{this.setState({scroll:e})},this.registerBadgeNode=e=>t=>{t&&(t.getAttribute("originOffsetTop")||t.setAttribute("originOffsetTop",String(t.offsetTop)),this.badges[e]=t)},this.shouldStick=e=>{const t=this.badges[e];return!!t&&Number(t.getAttribute("originOffsetTop"))<this.state.scroll+10},this.handleRangeChange=({value:e})=>{this.setState({range:e},()=>this.fetchAnalyses())},this.updateScroll=G()(this.updateScroll,20)}componentDidMount(){this.mounted=!0,this.fetchAnalyses(!0)}componentWillUnmount(){this.mounted=!1}scrollToSelected(){const e=document.querySelector(".branch-analysis.selected");this.scrollableNode&&e&&Object(z.scrollToElement)(e,{parent:this.scrollableNode,bottomOffset:40})}fetchAnalyses(e=!1){const{analysis:t,branch:n,component:a}=this.props,{range:r}=this.state;return this.setState({loading:!0}),Object(q.e)({branch:n,project:a,from:r?Object(_.toShortNotSoISOString)(Object(H.subDays)(new Date,r)):void 0}).then(n=>{e&&t&&!n.analyses.find(e=>e.key===t)?this.handleRangeChange({value:0}):this.setState({analyses:n.analyses.map(e=>function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?re(Object(n),!0).forEach((function(t){se(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):re(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({},e,{date:Object(_.parseDate)(e.date)})),loading:!1},()=>{this.scrollToSelected()})})}render(){const{analysis:e,onSelectAnalysis:t}=this.props,{analyses:n,loading:a,range:r}=this.state;return l.createElement(ae,{analyses:n,handleRangeChange:this.handleRangeChange,handleScroll:this.handleScroll,loading:a,onSelectAnalysis:t,range:r,registerBadgeNode:this.registerBadgeNode,registerScrollableNode:e=>{this.scrollableNode=e},selectedAnalysisKey:e,shouldStick:this.shouldStick})}}class ie extends l.PureComponent{constructor(e){super(e),this.mounted=!1,this.branchToOption=e=>({value:e.name,isMain:e.isMain,disabled:e.name===this.props.branch.name}),this.handleSubmit=e=>{e.preventDefault();const{branch:t,component:n}=this.props,{analysis:a,analysisDate:r,days:s,referenceBranch:c,selected:i}=this.state,l=Object(f.a)({type:i,analysis:a,days:s,referenceBranch:c});i&&(this.setState({saving:!0}),Object(m.d)({project:n,type:i,value:l,branch:t.name}).then(()=>{this.setState({saving:!1}),this.props.onClose(t.name,{type:i,value:l,effectiveValue:r&&Object(_.toNotSoISOString)(r)})},()=>{this.setState({saving:!1})}))},this.requestClose=()=>this.props.onClose(),this.handleSelectAnalysis=e=>this.setState({analysis:e.key,analysisDate:e.date}),this.handleSelectDays=e=>this.setState({days:e}),this.handleSelectReferenceBranch=e=>this.setState({referenceBranch:e}),this.handleSelectSetting=e=>this.setState({selected:e});const t=e.branchList.filter(t=>t.name!==e.branch.name),n=t.length>0?t[0].name:"";this.state={analysis:this.getValueFromProps("SPECIFIC_ANALYSIS")||"",days:this.getValueFromProps("NUMBER_OF_DAYS")||"30",referenceBranch:this.getValueFromProps("REFERENCE_BRANCH")||n,saving:!1,selected:this.props.branch.newCodePeriod&&this.props.branch.newCodePeriod.type}}componentDidMount(){this.mounted=!0}componentWillUnmount(){this.mounted=!1}getValueFromProps(e){return this.props.branch.newCodePeriod&&this.props.branch.newCodePeriod.type===e?this.props.branch.newCodePeriod.value:null}render(){const{branch:e,branchList:t}=this.props,{analysis:n,days:a,referenceBranch:r,saving:s,selected:c}=this.state,i=Object(p.translateWithParameters)("baseline.new_code_period_for_branch_x",e.name),o=e.newCodePeriod&&e.newCodePeriod.type,d=e.newCodePeriod&&e.newCodePeriod.value,{isChanged:u,isValid:m}=Object(f.c)({analysis:n,currentSetting:o,currentSettingValue:d,days:a,referenceBranch:r,selected:c});return l.createElement(j.a,{contentLabel:i,onRequestClose:this.requestClose,size:"large"},l.createElement("header",{className:"modal-head"},l.createElement("h2",null,i)),l.createElement("form",{onSubmit:this.handleSubmit},l.createElement("div",{className:"modal-body modal-container branch-baseline-setting-modal"},l.createElement("div",{className:"display-flex-row huge-spacer-bottom",role:"radiogroup"},l.createElement(k.a,{isDefault:!1,onSelect:this.handleSelectSetting,selected:"PREVIOUS_VERSION"===c}),l.createElement(P.a,{days:a,isChanged:u,isValid:m,onChangeDays:this.handleSelectDays,onSelect:this.handleSelectSetting,selected:"NUMBER_OF_DAYS"===c}),l.createElement(A,{onSelect:this.handleSelectSetting,selected:"SPECIFIC_ANALYSIS"===c}),l.createElement(U,{branchList:t.map(this.branchToOption),onChangeReferenceBranch:this.handleSelectReferenceBranch,onSelect:this.handleSelectSetting,referenceBranch:r,selected:"REFERENCE_BRANCH"===c,settingLevel:"branch"})),"SPECIFIC_ANALYSIS"===c&&l.createElement(ce,{analysis:n,branch:e.name,component:this.props.component,onSelectAnalysis:this.handleSelectAnalysis})),l.createElement("footer",{className:"modal-foot"},l.createElement(h.a,{className:"spacer-right",loading:s}),l.createElement(S.SubmitButton,{disabled:!u||s||!m},Object(p.translate)("save")),l.createElement(S.ResetButtonLink,{onClick:this.props.onClose},Object(p.translate)("cancel")))))}}var le=n(374),oe=n.n(le),de=n(961),ue=n.n(de),he=n(365),pe=n.n(he),me=n(596);function be(e){var t;const{branch:n,existingBranches:a,inheritedSetting:r}=e;let s;return!function(e,t){return!e.newCodePeriod&&"REFERENCE_BRANCH"===t.type&&e.name===t.value}(n,r)?function(e,t){return e.newCodePeriod&&e.newCodePeriod.value&&"REFERENCE_BRANCH"===e.newCodePeriod.type&&!t.includes(e.newCodePeriod.value)}(n,a)&&(s=Object(p.translateWithParameters)("baseline.reference_branch.does_not_exist",(null===(t=n.newCodePeriod)||void 0===t?void 0:t.value)||"")):s=Object(p.translateWithParameters)("baseline.reference_branch.invalid_branch_setting",n.name),l.createElement("tr",{className:s?"branch-setting-warning":""},l.createElement("td",{className:"nowrap"},l.createElement(me.a,{branchLike:n,className:"little-spacer-right"}),n.name,n.isMain&&l.createElement("div",{className:"badge spacer-left"},Object(p.translate)("branches.main_branch"))),l.createElement("td",{className:"huge-spacer-right nowrap"},l.createElement(D.a,{overlay:s},l.createElement("span",null,s&&l.createElement(ue.a,{className:"little-spacer-right"}),n.newCodePeriod?function(e){switch(e.type){case"SPECIFIC_ANALYSIS":return l.createElement(l.Fragment,null,"".concat(Object(p.translate)("baseline.specific_analysis"),": "),e.effectiveValue?l.createElement(pe.a,{date:e.effectiveValue}):"?");case"NUMBER_OF_DAYS":return"".concat(Object(p.translate)("baseline.number_days"),": ").concat(e.value);case"PREVIOUS_VERSION":return Object(p.translate)("baseline.previous_version");case"REFERENCE_BRANCH":return"".concat(Object(p.translate)("baseline.reference_branch"),": ").concat(e.value);default:return e.type}}(n.newCodePeriod):Object(p.translate)("branch_list.default_setting")))),l.createElement("td",{className:"text-right"},l.createElement(oe.a,null,l.createElement(le.ActionsDropdownItem,{onClick:()=>e.onOpenEditModal(n)},Object(p.translate)("edit")),n.newCodePeriod&&l.createElement(le.ActionsDropdownItem,{onClick:()=>e.onResetToDefault(n.name)},Object(p.translate)("reset_to_default")))))}function ge(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function fe(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class ye extends l.PureComponent{constructor(){super(...arguments),this.mounted=!1,this.state={branches:[],loading:!0},this.updateBranchNewCodePeriod=(e,t)=>{const{branches:n}=this.state,a=n.find(t=>t.name===e);return a&&(a.newCodePeriod=t),n.slice(0)},this.openEditModal=e=>{this.setState({editedBranch:e})},this.closeEditModal=(e,t)=>{e?this.setState({branches:this.updateBranchNewCodePeriod(e,t),editedBranch:void 0}):this.setState({editedBranch:void 0})},this.resetToDefault=e=>Object(m.c)({project:this.props.component.key,branch:e}).then(()=>{this.setState({branches:this.updateBranchNewCodePeriod(e,void 0)})})}componentDidMount(){this.mounted=!0,this.fetchBranches()}componentWillUnmount(){this.mounted=!1}sortAndFilterBranches(e=[]){return Object(g.j)(e.filter(g.f))}fetchBranches(){const e=this.props.component.key;this.setState({loading:!0}),Object(m.b)({project:e}).then(e=>{const t=e.newCodePeriods?e.newCodePeriods.filter(e=>!e.inherited):[],n=this.props.branchList.map(e=>{const n=t.find(t=>t.branchKey===e.name);if(!n)return e;const{type:a="PREVIOUS_VERSION",value:r,effectiveValue:s}=n;return function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ge(Object(n),!0).forEach((function(t){fe(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ge(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({},e,{newCodePeriod:{type:a,value:r,effectiveValue:s}})});this.setState({branches:n,loading:!1})},()=>{this.setState({loading:!1})})}render(){const{branchList:e,inheritedSetting:t}=this.props,{branches:n,editedBranch:a,loading:r}=this.state;return n.length<1?null:r?l.createElement(h.a,null):l.createElement(l.Fragment,null,l.createElement("table",{className:"data zebra"},l.createElement("thead",null,l.createElement("tr",null,l.createElement("th",null,Object(p.translate)("branch_list.branch")),l.createElement("th",{className:"nowrap huge-spacer-right"},Object(p.translate)("branch_list.current_setting")),l.createElement("th",{className:"thin nowrap"},Object(p.translate)("branch_list.actions")))),l.createElement("tbody",null,n.map(n=>l.createElement(be,{branch:n,existingBranches:e.map(e=>e.name),inheritedSetting:t,key:n.name,onOpenEditModal:this.openEditModal,onResetToDefault:this.resetToDefault})))),a&&l.createElement(ie,{branch:a,branchList:e,component:this.props.component.key,onClose:this.closeEditModal}))}}var ve=n(322);function Ee(e){return{value:e.name,isMain:e.isMain}}function Se(e){const{analysis:t,branch:n,branchList:a,branchesEnabled:r,component:s,currentSetting:c,currentSettingValue:o,days:d,generalSetting:u,overrideGeneralSetting:m,referenceBranch:b,saving:g,selected:y}=e,{isChanged:v,isValid:E}=Object(f.c)({analysis:t,currentSetting:c,currentSettingValue:o,days:d,overrideGeneralSetting:m,referenceBranch:b,selected:y});return l.createElement("form",{className:"project-baseline-selector",onSubmit:e.onSubmit},l.createElement("div",{className:"big-spacer-top spacer-bottom",role:"radiogroup"},l.createElement(Q.a,{checked:!m,className:"big-spacer-bottom",onCheck:()=>e.onToggleSpecificSetting(!1),value:"general"},Object(p.translate)("project_baseline.general_setting")),l.createElement("div",{className:"big-spacer-left"},function(e){let t,n;return"NUMBER_OF_DAYS"===e.type?(t="".concat(Object(p.translate)("baseline.number_days")," (").concat(Object(p.translateWithParameters)("duration.days",e.value||"?"),")"),n=Object(p.translate)("baseline.number_days.description")):(t=Object(p.translate)("baseline.previous_version"),n=Object(p.translate)("baseline.previous_version.description")),l.createElement("div",{className:"general-setting"},l.createElement("strong",null,t),": ",n)}(u)),l.createElement(Q.a,{checked:m,className:"huge-spacer-top",onCheck:()=>e.onToggleSpecificSetting(!0),value:"specific"},Object(p.translate)("project_baseline.specific_setting"))),l.createElement("div",{className:"big-spacer-left big-spacer-right project-baseline-setting"},l.createElement("div",{className:"display-flex-row big-spacer-bottom",role:"radiogroup"},l.createElement(k.a,{disabled:!m,onSelect:e.onSelectSetting,selected:m&&"PREVIOUS_VERSION"===y}),l.createElement(P.a,{days:d,disabled:!m,isChanged:v,isValid:E,onChangeDays:e.onSelectDays,onSelect:e.onSelectSetting,selected:m&&"NUMBER_OF_DAYS"===y}),r?l.createElement(U,{branchList:a.map(Ee),disabled:!m,onChangeReferenceBranch:e.onSelectReferenceBranch,onSelect:e.onSelectSetting,referenceBranch:b||"",selected:m&&"REFERENCE_BRANCH"===y,settingLevel:"project"}):l.createElement(A,{disabled:!m,onSelect:e.onSelectSetting,selected:m&&"SPECIFIC_ANALYSIS"===y})),"SPECIFIC_ANALYSIS"===y&&l.createElement(ce,{analysis:t||"",branch:n.name,component:s,onSelectAnalysis:e.onSelectAnalysis})),l.createElement("div",{className:i("big-spacer-top",{invisible:!v})},l.createElement(ve.Alert,{variant:"info",className:"spacer-bottom"},Object(p.translate)("baseline.next_analysis_notice")),l.createElement(h.a,{className:"spacer-right",loading:g}),l.createElement(S.SubmitButton,{disabled:g||!E||!v},Object(p.translate)("save")),l.createElement(S.ResetButtonLink,{className:"spacer-left",onClick:e.onCancel},Object(p.translate)("cancel"))))}const Oe={type:"PREVIOUS_VERSION"};class je extends l.PureComponent{constructor(){super(...arguments),this.mounted=!1,this.state={branchList:[],days:"30",loading:!0,saving:!1},this.resetSuccess=c()(()=>this.setState({success:void 0}),3e3),this.resetSetting=()=>{this.setState({saving:!0}),Object(m.c)({project:this.props.component.key}).then(()=>{this.setState({saving:!1,currentSetting:void 0,selected:void 0,success:!0}),this.resetSuccess()},()=>{this.setState({saving:!1})})},this.handleSelectAnalysis=e=>this.setState({analysis:e.key}),this.handleSelectDays=e=>this.setState({days:e}),this.handleSelectReferenceBranch=e=>{this.setState({referenceBranch:e})},this.handleCancel=()=>this.setState(({generalSetting:e=Oe,currentSetting:t,currentSettingValue:n})=>this.getUpdatedState({generalSetting:e,currentSetting:t,currentSettingValue:n})),this.handleSelectSetting=e=>this.setState({selected:e}),this.handleToggleSpecificSetting=e=>this.setState({overrideGeneralSetting:e}),this.handleSubmit=e=>{e.preventDefault();const{component:t}=this.props,{analysis:n,days:a,selected:r,referenceBranch:s,overrideGeneralSetting:c}=this.state;if(!c)return void this.resetSetting();const i=Object(f.a)({type:r,analysis:n,days:a,referenceBranch:s});r&&(this.setState({saving:!0}),Object(m.d)({project:t.key,type:r,value:i}).then(()=>{this.setState({saving:!1,currentSetting:r,currentSettingValue:i||void 0,success:!0}),this.resetSuccess()},()=>{this.setState({saving:!1})}))}}componentDidMount(){this.mounted=!0,this.fetchLeakPeriodSetting(),this.sortAndFilterBranches(this.props.branchLikes)}componentDidUpdate(e){e.branchLikes!==this.props.branchLikes&&this.sortAndFilterBranches(this.props.branchLikes)}componentWillUnmount(){this.mounted=!1}getUpdatedState(e){const{currentSetting:t,currentSettingValue:n,generalSetting:a}=e,{referenceBranch:r}=this.state,s="NUMBER_OF_DAYS"===a.type&&a.value||"30";return{loading:!1,currentSetting:t,currentSettingValue:n,generalSetting:a,selected:t||a.type,overrideGeneralSetting:Boolean(t),days:"NUMBER_OF_DAYS"===t&&n||s,analysis:"SPECIFIC_ANALYSIS"===t&&n||"",referenceBranch:"REFERENCE_BRANCH"===t&&n||r}}sortAndFilterBranches(e=[]){const t=Object(g.j)(e.filter(g.f));this.setState({branchList:t,referenceBranch:t[0].name})}fetchLeakPeriodSetting(){const{branchLike:e,branchesEnabled:t,component:n}=this.props;this.setState({loading:!0}),Promise.all([Object(m.a)(),Object(m.a)({branch:t?void 0:e.name,project:n.key})]).then(([e,t])=>{if(this.mounted){e.type||(e=Oe);const n=t.value,a=t.inherited?void 0:t.type||"PREVIOUS_VERSION";this.setState(this.getUpdatedState({generalSetting:e,currentSetting:a,currentSettingValue:n}))}},()=>{this.setState({loading:!1})})}render(){const{branchesEnabled:e,canAdmin:t,component:n,branchLike:a}=this.props,{analysis:r,branchList:s,currentSetting:c,days:o,generalSetting:u,loading:m,currentSettingValue:g,overrideGeneralSetting:f,referenceBranch:y,saving:v,selected:S,success:O}=this.state;return l.createElement(l.Fragment,null,l.createElement(b.a,{suggestions:"project_baseline"}),l.createElement("div",{className:"page page-limited"},l.createElement(E,{canAdmin:!!t}),m?l.createElement(h.a,null):l.createElement("div",{className:"panel-white project-baseline"},e&&l.createElement("h2",null,Object(p.translate)("project_baseline.default_setting")),u&&void 0!==f&&l.createElement(Se,{analysis:r,branch:a,branchList:s,branchesEnabled:e,component:n.key,currentSetting:c,currentSettingValue:g,days:o,generalSetting:u,onCancel:this.handleCancel,onSelectAnalysis:this.handleSelectAnalysis,onSelectDays:this.handleSelectDays,onSelectReferenceBranch:this.handleSelectReferenceBranch,onSelectSetting:this.handleSelectSetting,onSubmit:this.handleSubmit,onToggleSpecificSetting:this.handleToggleSpecificSetting,overrideGeneralSetting:f,referenceBranch:y,saving:v,selected:S}),l.createElement("div",{className:i("spacer-top",{invisible:v||!O})},l.createElement("span",{className:"text-success"},l.createElement(d.a,{className:"spacer-right"}),Object(p.translate)("settings.state.saved"))),u&&e&&l.createElement("div",{className:"huge-spacer-top branch-baseline-selector"},l.createElement("hr",null),l.createElement("h2",null,Object(p.translate)("project_baseline.configure_branches")),l.createElement(ye,{branchList:s,component:n,inheritedSetting:c?{type:c,value:g}:u})))))}}t.default=Object(a.b)(e=>({branchesEnabled:Object(r.getAppState)(e).branchesEnabled,canAdmin:Object(r.getAppState)(e).canAdmin}))(je)},341:function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var a=n(2),r=n(379);function s({suggestions:e}){return a.createElement(r.a.Consumer,null,({addSuggestions:t,removeSuggestions:n})=>a.createElement(c,{addSuggestions:t,removeSuggestions:n,suggestions:e}))}class c extends a.PureComponent{componentDidMount(){this.props.addSuggestions(this.props.suggestions)}componentDidUpdate(e){e.suggestions!==this.props.suggestions&&(this.props.removeSuggestions(this.props.suggestions),this.props.addSuggestions(e.suggestions))}componentWillUnmount(){this.props.removeSuggestions(this.props.suggestions)}render(){return null}}},430:function(e,t,n){"use strict";n.d(t,"a",(function(){return g})),n.d(t,"j",(function(){return v})),n.d(t,"e",(function(){return E})),n.d(t,"h",(function(){return S})),n.d(t,"i",(function(){return O})),n.d(t,"g",(function(){return j})),n.d(t,"d",(function(){return _})),n.d(t,"f",(function(){return N})),n.d(t,"l",(function(){return C})),n.d(t,"b",(function(){return A})),n.d(t,"k",(function(){return P})),n.d(t,"c",(function(){return k}));var a=n(330),r=n.n(a),s=n(384),c=n.n(s),i=n(532),l=n.n(i),o=n(655),d=n.n(o),u=n(31),h=n(16),p=n(359),m=n(396),b=n(512);const g=b.a.issues,f={[b.a.issues]:[m.a.bugs,m.a.code_smells,m.a.vulnerabilities],[b.a.coverage]:[m.a.lines_to_cover,m.a.uncovered_lines],[b.a.duplications]:[m.a.ncloc,m.a.duplicated_lines]},y={[b.a.issues]:f[b.a.issues].concat([m.a.reliability_rating,m.a.security_rating,m.a.sqale_rating]),[b.a.coverage]:[...f[b.a.coverage],m.a.coverage],[b.a.duplications]:[...f[b.a.duplications],m.a.duplicated_lines_density]};function v(e){return e===b.a.custom}function E(e=!1){const t=[b.a.issues,b.a.coverage,b.a.duplications];return e?t:[...t,b.a.custom]}function S(e){return e.data.some(e=>Boolean(e.y||0===e.y))}function O(e){return e.some(e=>e.data&&e.data.length>1)}function j(e){return e.length>0?e[0].type:"INT"}function _(e,t){return v(e)?t:f[e]}function N(e,t){return v(e)?t:y[e]}function C(e,t,n){return l()(c()(e,e=>e.type),e=>d()(e,n)).slice(0,t)}function A(e,t,n,a){return a.length<=0||void 0===e?[]:r()(e.filter(e=>a.indexOf(e.metric)>=0).map(a=>{if(a.metric===m.a.uncovered_lines&&!v(t))return function(e,t){const n=t.find(e=>e.metric===m.a.lines_to_cover);return{data:n?e.history.map((e,t)=>({x:e.date,y:Number(n.history[t].value)-Number(e.value)})):[],name:"covered_lines",translatedName:Object(u.translate)("project_activity.custom_metric.covered_lines"),type:"INT"}}(a,e);const r=function(e,t){if(Array.isArray(t))return t.find(t=>t.key===e);return t[e]}(a.metric,n);return{data:a.history.map(e=>({x:e.date,y:r&&"LEVEL"===r.type?e.value:Number(e.value)})),name:a.metric,translatedName:r?Object(u.getLocalizedMetricName)(r):Object(p.localizeMetric)(a.metric),type:r?r.type:"INT"}}),e=>a.indexOf("covered_lines"===e.name?"uncovered_lines":e.name))}function P(e,t,n,a=[]){Object(h.save)(e,n,t),v(n)&&Object(h.save)("".concat(e,".custom"),a.join(","),t)}function k(e,t){const n=Object(h.get)("".concat(e,".custom"),t);return{graph:Object(h.get)(e,t)||g,customGraphs:n?n.split(","):[]}}},512:function(e,t,n){"use strict";var a;n.d(t,"a",(function(){return a})),function(e){e.issues="issues",e.coverage="coverage",e.duplications="duplications",e.custom="custom"}(a||(a={}))},596:function(e,t,n){"use strict";n.d(t,"a",(function(){return d}));var a=n(2),r=n(407),s=n.n(r),c=n(529),i=n.n(c),l=n(328);function o(e,t){if(null==e)return{};var n,a,r=function(e,t){if(null==e)return{};var n,a,r={},s=Object.keys(e);for(a=0;a<s.length;a++)n=s[a],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(a=0;a<s.length;a++)n=s[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function d(e){let{branchLike:t}=e,n=o(e,["branchLike"]);return Object(l.h)(t)?a.createElement(i.a,Object.assign({},n)):a.createElement(s.a,Object.assign({},n))}},686:function(e,t,n){"use strict";n.d(t,"b",(function(){return d})),n.d(t,"a",(function(){return u})),n.d(t,"c",(function(){return h})),n.d(t,"d",(function(){return p})),n.d(t,"e",(function(){return m})),n.d(t,"g",(function(){return b})),n.d(t,"f",(function(){return g})),n.d(t,"h",(function(){return f})),n.d(t,"i",(function(){return y})),n.d(t,"j",(function(){return v}));var a=n(585),r=n.n(a),s=n(548),c=n(26),i=n(479),l=n(430),o=n(512);const d=["VERSION","QUALITY_GATE","QUALITY_PROFILE","OTHER"],u=["QUALITY_GATE","DEFINITION_CHANGE","OTHER"];function h(e,t){return e.category!==t.category||m(e,t)}function p(e,t){return!r()(e.customMetrics,t.customMetrics)}function m(e,t){return!r()(e.from,t.from)||!r()(e.to,t.to)}function b(e,t){return e.graph!==t.graph}function g(e,t){return e.reduce((e,n)=>{let a=e[e.length-1];const r=n.events.find(e=>"VERSION"===e.category);if(r){const t={version:r.name,key:r.key,byDay:{}};!a||Object.keys(a.byDay).length>0?e.push(t):e[e.length-1]=t,a=t}else a||(a={version:null,key:null,byDay:{}},e.push(a));const i=s(Object(c.parseDate)(n.date)).getTime().toString();let l=!0;if(t.category||t.from||t.to){const e=!t.from||n.date>=t.from,a=!t.to||n.date<=t.to,r=!t.category||null!=n.events.find(e=>e.category===t.category);l=e&&a&&r}return l&&(a.byDay[i]||(a.byDay[i]=[]),a.byDay[i].push(n)),e},[])}function f(e){return{category:Object(i.parseAsString)(e.category),customMetrics:Object(i.parseAsArray)(e.custom_metrics,i.parseAsString),from:Object(i.parseAsDate)(e.from),graph:E(e.graph),project:Object(i.parseAsString)(e.id),to:Object(i.parseAsDate)(e.to),selectedDate:Object(i.parseAsDate)(e.selected_date)}}function y(e){return Object(i.cleanQuery)({category:Object(i.serializeString)(e.category),from:Object(i.serializeDate)(e.from),project:Object(i.serializeString)(e.project),to:Object(i.serializeDate)(e.to)})}function v(e){return Object(i.cleanQuery)({category:Object(i.serializeString)(e.category),custom_metrics:Object(i.serializeStringArray)(e.customMetrics),from:Object(i.serializeDate)(e.from),graph:(t=e.graph,t===l.a?void 0:t),id:Object(i.serializeString)(e.project),to:Object(i.serializeDate)(e.to),selected_date:Object(i.serializeDate)(e.selectedDate)});var t}function E(e){const t=Object(i.parseAsString)(e);return Object.keys(o.a).includes(t)?t:l.a}},698:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var a=n(2);const r=a.createContext({branchLike:void 0,component:void 0})},753:function(e,t,n){"use strict";n.d(t,"e",(function(){return s})),n.d(t,"b",(function(){return c})),n.d(t,"d",(function(){return i})),n.d(t,"a",(function(){return l})),n.d(t,"c",(function(){return o}));var a=n(9),r=n(324);function s(e){return Object(a.getJSON)("/api/project_analyses/search",e).catch(r.a)}function c(e,t,n,s){const c={analysis:e,name:t};return n&&(c.category=n),s&&(c.description=s),Object(a.postJSON)("/api/project_analyses/create_event",c).then(e=>e.event,r.a)}function i(e){return Object(a.post)("/api/project_analyses/delete_event",{event:e}).catch(r.a)}function l(e,t,n){const s={event:e};return t&&(s.name=t),n&&(s.description=n),Object(a.postJSON)("/api/project_analyses/update_event",s).then(e=>e.event,r.a)}function o(e){return Object(a.post)("/api/project_analyses/delete",{analysis:e}).catch(r.a)}},755:function(e,t,n){"use strict";n.d(t,"b",(function(){return b})),n.d(t,"a",(function(){return g}));var a=n(2),r=n(316),s=n(318),c=n(312),i=n(407),l=n.n(i),o=n(334),d=n.n(o),u=n(31),h=n(406),p=n(328),m=n(321);function b(e){return"DEFINITION_CHANGE"===e.category&&void 0!==e.definitionChange}class g extends a.PureComponent{constructor(){super(...arguments),this.state={expanded:!1},this.stopPropagation=e=>{e.stopPropagation()},this.toggleProjectsList=()=>{this.setState(e=>({expanded:!e.expanded}))},this.renderProjectLink=(e,t)=>a.createElement(s.c,{onClick:this.stopPropagation,title:e.name,to:Object(m.v)(e.key,t)},Object(h.limitComponentName)(e.name,28)),this.renderBranch=(e=Object(u.translate)("branches.main_branch"))=>a.createElement("span",{className:"nowrap",title:e},a.createElement(l.a,{className:"little-spacer-left text-text-top"}),e)}renderProjectChange(e){const t=!this.props.branchLike||Object(p.g)(this.props.branchLike);if("ADDED"===e.changeType){const n=t?"event.definition_change.added":"event.definition_change.branch_added";return a.createElement("div",{className:"text-ellipsis"},a.createElement(r.FormattedMessage,{defaultMessage:Object(u.translate)(n),id:n,values:{project:this.renderProjectLink(e,e.branch),branch:this.renderBranch(e.branch)}}))}if("REMOVED"===e.changeType){const n=t?"event.definition_change.removed":"event.definition_change.branch_removed";return a.createElement("div",{className:"text-ellipsis"},a.createElement(r.FormattedMessage,{defaultMessage:Object(u.translate)(n),id:n,values:{project:this.renderProjectLink(e,e.branch),branch:this.renderBranch(e.branch)}}))}return"BRANCH_CHANGED"===e.changeType?a.createElement(r.FormattedMessage,{defaultMessage:Object(u.translate)("event.definition_change.branch_replaced"),id:"event.definition_change.branch_replaced",values:{project:this.renderProjectLink(e,e.newBranch),oldBranch:this.renderBranch(e.oldBranch),newBranch:this.renderBranch(e.newBranch)}}):null}render(){const{event:e}=this.props,{expanded:t}=this.state;return a.createElement(a.Fragment,null,a.createElement("span",{className:"note"},Object(u.translate)("event.category",e.category),":"),a.createElement("div",null,a.createElement(c.ResetButtonLink,{className:"project-activity-event-inner-more-link",onClick:this.toggleProjectsList,stopPropagation:!0},t?Object(u.translate)("hide"):Object(u.translate)("more"),a.createElement(d.a,{className:"little-spacer-left",turned:t}))),t&&a.createElement("ul",{className:"spacer-left spacer-top"},e.definitionChange.projects.map(e=>a.createElement("li",{className:"display-flex-center spacer-top",key:e.key},this.renderProjectChange(e)))))}}},756:function(e,t,n){"use strict";n.d(t,"b",(function(){return p})),n.d(t,"a",(function(){return m}));var a=n(2),r=n(316),s=n(318),c=n(312),i=n(334),l=n.n(i),o=n(386),d=n.n(o),u=n(31),h=n(321);function p(e){return"QUALITY_GATE"===e.category&&void 0!==e.qualityGate}class m extends a.PureComponent{constructor(){super(...arguments),this.state={expanded:!1},this.stopPropagation=e=>{e.stopPropagation()},this.toggleProjectsList=()=>{this.setState(e=>({expanded:!e.expanded}))}}render(){const{event:e}=this.props,{expanded:t}=this.state;return a.createElement(a.Fragment,null,a.createElement("span",{className:"note spacer-right"},Object(u.translate)("event.category",e.category),":"),e.qualityGate.stillFailing?a.createElement(r.FormattedMessage,{defaultMessage:Object(u.translate)("event.quality_gate.still_x"),id:"event.quality_gate.still_x",values:{status:a.createElement(d.a,{level:e.qualityGate.status,small:!0})}}):a.createElement(d.a,{level:e.qualityGate.status,small:!0}),a.createElement("div",null,e.qualityGate.failing.length>0&&a.createElement(c.ResetButtonLink,{className:"project-activity-event-inner-more-link",onClick:this.toggleProjectsList,stopPropagation:!0},t?Object(u.translate)("hide"):Object(u.translate)("more"),a.createElement(l.a,{className:"little-spacer-left",turned:t}))),t&&a.createElement("ul",{className:"spacer-left spacer-top"},e.qualityGate.failing.map(t=>a.createElement("li",{className:"display-flex-center spacer-top",key:t.key},a.createElement(d.a,{"aria-label":Object(u.translate)("quality_gates.status"),className:"spacer-right",level:e.qualityGate.status,small:!0}),a.createElement("div",{className:"flex-1 text-ellipsis"},a.createElement(s.c,{onClick:this.stopPropagation,title:t.name,to:Object(h.v)(t.key,t.branch)},a.createElement("span",{"aria-label":Object(u.translateWithParameters)("project_x",t.name)},t.name)))))))}}},761:function(e,t,n){"use strict";n.d(t,"a",(function(){return s})),n.d(t,"d",(function(){return c})),n.d(t,"c",(function(){return i})),n.d(t,"b",(function(){return l}));var a=n(9),r=n(324);function s(e){return Object(a.getJSON)("/api/new_code_periods/show",e).catch(r.a)}function c(e){return Object(a.post)("/api/new_code_periods/set",e).catch(r.a)}function i(e){return Object(a.post)("/api/new_code_periods/unset",e).catch(r.a)}function l(e){return Object(a.getJSON)("/api/new_code_periods/list",e).catch(r.a)}},762:function(e,t,n){"use strict";function a(e){const t=parseInt(e,10);return!(e.length<1||isNaN(t)||t<1||String(t)!==e)}function r({analysis:e,days:t,referenceBranch:n,type:a}){switch(a){case"NUMBER_OF_DAYS":return t;case"REFERENCE_BRANCH":return n;case"SPECIFIC_ANALYSIS":return e;default:return}}function s(e){const{analysis:t="",currentSetting:n,currentSettingValue:r,days:s,overrideGeneralSetting:c,referenceBranch:i="",selected:l}=e;let o;return o=n||void 0===c?!1===c||l!==n||"NUMBER_OF_DAYS"===l&&s!==r||"SPECIFIC_ANALYSIS"===l&&t!==r||"REFERENCE_BRANCH"===l&&i!==r:c,{isChanged:o,isValid:!1===c||"PREVIOUS_VERSION"===l||"SPECIFIC_ANALYSIS"===l&&t.length>0||"NUMBER_OF_DAYS"===l&&a(s)||"REFERENCE_BRANCH"===l&&i.length>0}}n.d(t,"b",(function(){return a})),n.d(t,"a",(function(){return r})),n.d(t,"c",(function(){return s}))},808:function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var a=n(2),r=n(660),s=n.n(r),c=n(551),i=n.n(c),l=n(346),o=n.n(l),d=n(31);function u(e){const{className:t,days:n,disabled:r,isChanged:c,isValid:l,onChangeDays:u,onSelect:h,selected:p}=e;return a.createElement(s.a,{className:t,disabled:r,onClick:()=>h("NUMBER_OF_DAYS"),selected:p,title:Object(d.translate)("baseline.number_days")},a.createElement(a.Fragment,null,a.createElement("p",{className:"big-spacer-bottom"},Object(d.translate)("baseline.number_days.description")),p&&a.createElement(a.Fragment,null,a.createElement(o.a,null),a.createElement(i.a,{error:void 0,id:"baseline_number_of_days",isInvalid:c&&!l,isValid:c&&l,label:Object(d.translate)("baseline.specify_days"),required:!0},a.createElement("input",{onChange:e=>u(e.currentTarget.value),type:"text",value:n})))))}},809:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var a=n(2),r=n(660),s=n.n(r),c=n(31);function i(e){const{disabled:t,isDefault:n,onSelect:r,selected:i}=e;return a.createElement(s.a,{disabled:t,onClick:()=>r("PREVIOUS_VERSION"),selected:i,title:Object(c.translate)("baseline.previous_version")+(n?" (".concat(Object(c.translate)("default"),")"):"")},a.createElement("p",null,Object(c.translate)("baseline.previous_version.description")))}},980:function(e,t,n){"use strict";var a=n(330),r=n.n(a),s=n(2),c=n(311),i=n(312),l=n(618),o=n.n(l),d=n(31),u=n(317),h=n.n(u),p=n(698),m=n(755),b=n(756);function g({event:e}){if(Object(b.b)(e))return s.createElement(b.a,{event:e});if(Object(m.b)(e))return s.createElement(p.a.Consumer,null,({branchLike:t})=>s.createElement(m.a,{branchLike:t,event:e}));{const t=s.createElement("span",{className:"text-middle"},s.createElement("span",{className:"note little-spacer-right"},Object(d.translate)("event.category",e.category),":"),s.createElement("strong",{className:"spacer-right"},e.name));return e.description?s.createElement(h.a,{overlay:e.description},t):t}}var f=n(358),y=n.n(f);class v extends s.PureComponent{constructor(e){super(e),this.changeInput=e=>{this.setState({name:e.target.value})},this.handleSubmit=()=>this.props.changeEvent(this.props.event.key,this.state.name),this.state={name:e.event.name}}render(){const{name:e}=this.state;return s.createElement(y.a,{confirmButtonText:Object(d.translate)("change_verb"),confirmDisable:!e||e===this.props.event.name,header:this.props.header,onClose:this.props.onClose,onConfirm:this.handleSubmit,size:"small"},s.createElement("div",{className:"modal-field"},s.createElement("label",null,Object(d.translate)("name")),s.createElement("input",{autoFocus:!0,onChange:this.changeInput,type:"text",value:e})))}}function E(e){const{analysisKey:t,event:n,header:a,removeEventQuestion:r}=e;return s.createElement(y.a,{confirmButtonText:Object(d.translate)("delete"),header:a,isDestructive:!0,onClose:e.onClose,onConfirm:()=>e.onConfirm(t,n.key)},r)}var S=s.memo((function(e){const{analysisKey:t,event:n,canAdmin:a,isFirst:r}=e,[l,u]=s.useState(!1),[h,p]=s.useState(!1),m="OTHER"===n.category,b="VERSION"===n.category,f=(m||b)&&e.onChange,y=(m||b&&!r)&&e.onDelete,S=a&&(f||y);return s.createElement("div",{className:"project-activity-event"},s.createElement(o.a,{className:c("project-activity-event-icon little-spacer-right text-middle",n.category)}),s.createElement(g,{event:n}),S&&s.createElement("span",{className:"nowrap"},f&&s.createElement(i.EditButton,{"aria-label":Object(d.translate)("project_activity.events.tooltip.edit"),className:"button-small","data-test":"project-activity__edit-event",onClick:()=>u(!0),stopPropagation:!0}),y&&s.createElement(i.DeleteButton,{"aria-label":Object(d.translate)("project_activity.events.tooltip.delete"),className:"button-small","data-test":"project-activity__delete-event",onClick:()=>p(!0),stopPropagation:!0})),l&&e.onChange&&s.createElement(v,{changeEvent:e.onChange,event:n,header:b?Object(d.translate)("project_activity.change_version"):Object(d.translate)("project_activity.change_custom_event"),onClose:()=>u(!1)}),h&&e.onDelete&&s.createElement(E,{analysisKey:t,event:n,header:b?Object(d.translate)("project_activity.remove_version"):Object(d.translate)("project_activity.remove_custom_event"),onClose:()=>p(!1),onConfirm:e.onDelete,removeEventQuestion:Object(d.translate)("project_activity.".concat(b?"remove_version":"remove_custom_event",".question"))}))}));t.a=s.memo((function(e){const{analysisKey:t,canAdmin:n,events:a,isFirst:c}=e,i=r()(a,e=>"VERSION"===e.category?1:0,"category");return s.createElement("div",{className:"big-spacer-top"},i.map(a=>s.createElement(S,{analysisKey:t,canAdmin:n,event:a,isFirst:c,key:a.key,onChange:e.onChange,onDelete:e.onDelete})))}))}}]);
//# sourceMappingURL=304.m.ec2ba24c.chunk.js.map